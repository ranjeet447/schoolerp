# OpenAPI Specification — SchoolERP v1
# Base file used by cmd/openapi-bundle to generate openapi.yaml.

openapi: 3.1.0
info:
  title: SchoolERP API
  version: 1.0.0
  description: |
    Comprehensive API documentation for the SchoolERP platform.
    This API handles everything from student management, finance, and exams
    to AI-powered parent helpdesks and cross-campus analytics.

    ### Authentication
    Most endpoints require a signed JWT token in the `Authorization` header:
    `Authorization: Bearer <your_token_here>`

    ### Multi-tenancy
    The API supports multi-tenancy. You must specify the tenant ID in the
    `X-Tenant-ID` header or ensure the request is routed via the tenant's subdomain.

    ### Response Formats
    All responses are in JSON format and follow a consistent structure:
    - Success: `{ "success": true, "data": { ... } }`
    - Error: `{ "success": false, "message": "error description", "code": "ERR_CODE" }`

servers:
  - url: http://localhost:8080/v1
    description: Local development server
  - url: https://schoolerp-vmn1.onrender.com/v1
    description: Production API

tags:
  - name: Auth
    description: Login, MFA, Password Reset, Legal Docs
  - name: Students
    description: SIS, Academic Structure, Student 360, Custom Fields
  - name: Finance
    description: Fees, Payments, Receipts, Scholarships, Concessions
  - name: Exams
    description: Exam Management, Marks, Grading, Hall Tickets
  - name: Attendance
    description: Student and Staff Attendance
  - name: Dashboard
    description: Operational and Strategic Analytics
  - name: Notices
    description: Circulars, Notices, and Broadcast Notifications
  - name: Academics
    description: Homework, Lesson Plans, Timetable, Certificates
  - name: Schedule
    description: Timetable Slots, Substitutions, Teacher Lessons
  - name: Transport
    description: Vehicles, Routes, Stops, Allocations
  - name: Library
    description: Books, Issues, Digital Assets, Reading Progress
  - name: Inventory
    description: Stock, Suppliers, POs, Requisitions
  - name: Admissions
    description: Enquiries, Applications, Enrollment Workflow
  - name: HRMS
    description: Employees, Salary, Payroll, Staff Tasks
  - name: Safety
    description: Incidents, Visitors, Gate Passes, Alerts
  - name: Communication
    description: WhatsApp Config, Broadcast Logs, CRM
  - name: AI
    description: Parent Helpdesk, Multi-turn Chat, LLM Insights
  - name: Knowledge Base
    description: Tenant KB documents, settings, and semantic search
  - name: Automation
    description: Rule-based automation workflows and schedules
  - name: Roles
    description: RBAC, Custom Roles, Permissions
  - name: Public
    description: Marketing Site Forms, Demo Bookings, Reviews
  - name: Platform
    description: Global Tenant Management (Super Admin only)

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
    TenantId:
      type: apiKey
      in: header
      name: X-Tenant-ID

security:
  - BearerAuth: []
    TenantId: []

paths:
  # from paths/auth.yaml
  # Auth, Health, Files, Tenant Config — Detailed API Paths
  # All responses use application/json unless otherwise noted.
  
  /auth/login:
    post:
      operationId: authLogin
      tags: [Auth]
      summary: Authenticate with email and password
      description: |
        Authenticates a user by verifying email/password against the database.
        On success, returns a signed JWT token containing the user's role,
        tenant_id, and permissions array.
  
        **Flow variants:**
        - `403 legal_acceptance_required` — User must accept updated legal docs before login completes.
          The response includes `meta.preauth_token` and `meta.requirements[]`.
        - `403 mfa_required` — User has MFA enabled; call `/auth/mfa/validate` next.
        - `403 access_blocked` — Account has been blocked by an admin.
        - `403 password_expired` — Password must be reset.
        - `503` — Session store (Redis) is unavailable.
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email:
                  type: string
                  format: email
                  description: User's email address (case-insensitive)
                  example: admin@school.in
                password:
                  type: string
                  description: Plain-text password
                  example: secret123
      responses:
        '200':
          description: Login successful — JWT token and user info returned
          content:
            application/json:
              schema:
                type: object
                properties:
                  success: { type: boolean, example: true }
                  data:
                    type: object
                    properties:
                      token:
                        type: string
                        description: "Signed JWT (HS256) — include as `Authorization: Bearer <token>`"
                      user_id: { type: string, format: uuid }
                      email: { type: string, format: email }
                      full_name: { type: string, example: "Ranjeet Singh" }
                      role:
                        type: string
                        enum: [super_admin, tenant_admin, teacher, parent, student, accountant]
                      tenant_id: { type: string, format: uuid }
                      permissions:
                        type: array
                        items: { type: string }
                        description: Flat list of permission codes, e.g. `["finance:read", "students:write"]`
                      expires_at: { type: string, format: date-time }
        '400':
          description: Missing or malformed request body
          content:
            application/json:
              schema:
                type: object
                properties:
                  success: { type: boolean, example: false }
                  message: { type: string, example: "Email and password are required" }
        '401':
          description: Invalid credentials (wrong email or password)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success: { type: boolean, example: false }
                  message: { type: string, example: "invalid credentials" }
        '403':
          description: |
            Login blocked — one of: MFA required, legal acceptance required,
            access blocked, or password expired. Check `code` field.
          content:
            application/json:
              schema:
                type: object
                properties:
                  success: { type: boolean, example: false }
                  code:
                    type: string
                    enum: [legal_acceptance_required, mfa_required, access_blocked, password_expired]
                  message: { type: string }
                  meta:
                    type: object
                    description: Additional context (e.g. legal requirements, preauth_token)
        '503':
          description: Session store unavailable (Redis down)
  
  /auth/forgot-password:
    post:
      operationId: authForgotPassword
      tags: [Auth]
      summary: Request password reset email
      description: |
        Sends a password reset email to the given address if an account exists.
        **Always returns 200** regardless of whether the email exists (security best practice).
        Logs the IP address and user agent for audit purposes.
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email]
              properties:
                email:
                  type: string
                  format: email
                  description: Email address to send the reset link to
                  example: teacher@school.in
      responses:
        '200':
          description: Reset email sent (or silently ignored if account doesn't exist)
          content:
            application/json:
              schema:
                type: object
                properties:
                  success: { type: boolean, example: true }
                  message: { type: string, example: "If an account exists, a reset link has been sent" }
        '400':
          description: Missing email field
  
  /auth/mfa/setup:
    post:
      operationId: authMfaSetup
      tags: [Auth]
      summary: Generate MFA secret and QR code
      description: |
        Generates a new TOTP secret for the authenticated user.
        Returns the raw secret and a QR code URL/data that can be scanned
        by an authenticator app (Google Authenticator, Authy, etc.).
        MFA is not yet enabled — call `/auth/mfa/enable` with a valid code to activate.
      responses:
        '200':
          description: MFA setup data
          content:
            application/json:
              schema:
                type: object
                properties:
                  secret:
                    type: string
                    description: Base32-encoded TOTP secret for manual entry
                    example: JBSWY3DPEHPK3PXP
                  qr_code:
                    type: string
                    description: QR code image data (base64 PNG or otpauth:// URI)
        '401':
          description: Not authenticated
  
  /auth/mfa/enable:
    post:
      operationId: authMfaEnable
      tags: [Auth]
      summary: Enable MFA by verifying a TOTP code
      description: |
        Verifies the provided 6-digit TOTP code against the previously generated
        secret. On success, MFA is permanently enabled for the user's account.
        All subsequent logins will require MFA validation.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [code]
              properties:
                code:
                  type: string
                  minLength: 6
                  maxLength: 6
                  description: 6-digit TOTP code from the authenticator app
                  example: "482910"
      responses:
        '200':
          description: MFA enabled successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success: { type: boolean, example: true }
        '400':
          description: Invalid or expired TOTP code
        '401':
          description: Not authenticated
  
  /auth/mfa/validate:
    post:
      operationId: authMfaValidate
      tags: [Auth]
      summary: Validate MFA code during login flow
      description: |
        Called after a `403 mfa_required` response from `/auth/login`.
        Validates the provided TOTP code and, on success, returns `{ valid: true }`.
        The client should then re-issue the login request or use the pre-auth token
        to obtain a full JWT.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [code]
              properties:
                code:
                  type: string
                  minLength: 6
                  maxLength: 6
                  description: 6-digit TOTP code
                  example: "384721"
      responses:
        '200':
          description: MFA code is valid
          content:
            application/json:
              schema:
                type: object
                properties:
                  valid: { type: boolean, example: true }
        '401':
          description: Invalid TOTP code
  
  /auth/legal/docs:
    get:
      operationId: authListLegalDocs
      tags: [Auth]
      summary: List current legal documents
      description: |
        Returns all currently published legal documents (Terms of Service,
        Privacy Policy, etc.) that users may need to accept. Each document
        includes a `doc_key`, `title`, `version`, `content_url`, and `published_at`.
      security: []
      responses:
        '200':
          description: Legal documents list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success: { type: boolean, example: true }
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        doc_key: { type: string, example: terms_of_service }
                        title: { type: string, example: "Terms of Service" }
                        version: { type: string, example: "2.1" }
                        content_url: { type: string, format: uri }
                        published_at: { type: string, format: date-time }
  
  /auth/legal/accept:
    post:
      operationId: authAcceptLegalDocs
      tags: [Auth]
      summary: Accept legal documents and receive login token
      description: |
        Called after a `403 legal_acceptance_required` response from `/auth/login`.
        Requires the `preauth_token` from the login response as the Bearer token.
        Accepts one or more legal documents by `doc_key` + `version`, then issues
        a full JWT on success.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [accept]
              properties:
                accept:
                  type: array
                  description: List of legal documents being accepted
                  items:
                    type: object
                    required: [doc_key, version]
                    properties:
                      doc_key:
                        type: string
                        description: Unique key of the legal document
                        example: terms_of_service
                      version:
                        type: string
                        description: Version being accepted
                        example: "2.1"
      responses:
        '200':
          description: Documents accepted, full login token issued
          content:
            application/json:
              schema:
                type: object
                properties:
                  success: { type: boolean, example: true }
                  data:
                    type: object
                    properties:
                      token: { type: string }
                      user_id: { type: string, format: uuid }
                      email: { type: string, format: email }
                      full_name: { type: string }
                      role: { type: string }
                      tenant_id: { type: string, format: uuid }
                      permissions: { type: array, items: { type: string } }
                      expires_at: { type: string, format: date-time }
        '400':
          description: Invalid request or acceptance data
        '401':
          description: Invalid or expired preauth token
  
  /auth/request-otp:
    post:
      operationId: authRequestOtp
      tags: [Auth]
      summary: Request a one-time password for login
      description: |
        Sends an OTP to the user's registered mobile/email for passwordless login.
      security: []
      responses:
        '200':
          description: OTP sent successfully
  
  /healthz:
    get:
      operationId: healthCheck
      tags: [Auth]
      summary: API health check
      description: |
        Returns the API server status and current timestamp. Used by load balancers,
        monitoring systems, and uptime checkers. No authentication required.
      security: []
      responses:
        '200':
          description: Server is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: ok
                    description: Always "ok" if the server is running
                  timestamp:
                    type: string
                    format: date-time
                    description: Current server time
  
  /files/upload:
    post:
      operationId: uploadFile
      tags: [Files]
      summary: Upload a file to S3
      description: |
        Uploads a file to the tenant's S3 bucket and returns the public URL.
        Supports images, PDFs, and documents. Max file size is governed by
        the server's request body limit (typically 50MB).
        The file is stored under the tenant's namespace with a unique key.
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [file]
              properties:
                file:
                  type: string
                  format: binary
                  description: The file to upload
      responses:
        '200':
          description: File uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  url:
                    type: string
                    format: uri
                    description: Public URL of the uploaded file
                  filename:
                    type: string
                    description: Original filename
                  size:
                    type: integer
                    description: File size in bytes
                  mime_type:
                    type: string
                    description: Detected MIME type
                    example: image/png
  
  /tenants/config:
    get:
      operationId: getTenantConfig
      tags: [Tenant]
      summary: Get tenant configuration (public)
      description: |
        Returns the public-facing configuration for a tenant including
        school name, branding, enabled modules, and feature flags.
        Resolved from the `X-Tenant-ID` header or domain mapping.
      security: []
      parameters:
        - name: X-Tenant-ID
          in: header
          schema: { type: string, format: uuid }
          description: Optional tenant ID header (also resolved from domain)
      responses:
        '200':
          description: Tenant configuration
          content:
            application/json:
              schema:
                type: object
                properties:
                  tenant_id: { type: string, format: uuid }
                  school_name: { type: string }
                  logo_url: { type: string, format: uri }
                  modules: { type: array, items: { type: string } }
                  feature_flags: { type: object, additionalProperties: { type: boolean } }

  # from paths/public.yaml
  # Public / Marketing API Paths
  
  /public/demo-bookings:
    post:
      operationId: publicCreateDemoBooking
      tags: [Public]
      summary: Book a product demo
      description: |
        Allows prospective schools to book a product demo. Creates a booking record
        and triggers an email notification to the sales team. Idempotent when
        `Idempotency-Key` header is provided.
      security: []
      parameters:
        - name: Idempotency-Key
          in: header
          schema: { type: string }
          description: Optional idempotency key to prevent duplicate bookings
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [school_name, contact_name, email, phone]
              properties:
                school_name:
                  type: string
                  description: Name of the school requesting the demo
                  example: "Greenfield Public School"
                contact_name:
                  type: string
                  description: Contact person's full name
                  example: "Rakesh Kumar"
                email:
                  type: string
                  format: email
                  description: Contact email
                  example: principal@greenfield.edu.in
                phone:
                  type: string
                  description: Phone number with country code
                  example: "+919876543210"
                city:
                  type: string
                  description: City where the school is located
                  example: "Jaipur"
                student_count:
                  type: integer
                  description: Approximate number of students
                  example: 1200
      responses:
        '201':
          description: Demo booking created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id: { type: string, format: uuid }
                  status: { type: string, example: pending }
  
  /public/contact:
    post:
      operationId: publicSubmitContact
      tags: [Public]
      summary: Submit contact form
      description: |
        Submits a general contact/enquiry form from the marketing website.
        Stores the submission and sends a notification to the support team.
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, email, message]
              properties:
                name: { type: string, example: "Priya Sharma" }
                email: { type: string, format: email }
                message: { type: string, description: "Free-form enquiry message" }
      responses:
        '201':
          description: Contact form submitted
  
  /public/partner-applications:
    post:
      operationId: publicSubmitPartnerApplication
      tags: [Public]
      summary: Submit a partner/reseller application
      description: |
        Allows potential partners or channel resellers to apply for a partnership.
        The application is queued for review by the platform team.
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, organization, email]
              properties:
                name: { type: string }
                organization: { type: string }
                email: { type: string, format: email }
                phone: { type: string }
                region: { type: string }
      responses:
        '201':
          description: Partner application submitted
  
  /public/review-requests/{token}:
    get:
      operationId: publicGetReviewRequest
      tags: [Public]
      summary: Get review request details by token
      description: |
        Retrieves a review request using a unique token sent via email.
        Used to pre-populate the review submission form with school details.
      security: []
      parameters:
        - name: token
          in: path
          required: true
          schema: { type: string }
          description: Unique review request token (from email link)
      responses:
        '200':
          description: Review request details
          content:
            application/json:
              schema:
                type: object
                properties:
                  school_name: { type: string }
                  reviewer_name: { type: string }
                  reviewer_email: { type: string, format: email }
        '404':
          description: Token not found or expired
  
  /public/reviews:
    post:
      operationId: publicSubmitReview
      tags: [Public]
      summary: Submit a product review
      description: |
        Submits a public review/testimonial. Must include a valid review request
        token (obtained from `/public/review-requests/{token}`).
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [token, rating]
              properties:
                token: { type: string, description: Review request token }
                rating: { type: integer, minimum: 1, maximum: 5 }
                comment: { type: string }
      responses:
        '201':
          description: Review submitted successfully
  
  /public/case-studies/{slug}/pdf:
    post:
      operationId: publicCreateCaseStudyPdf
      tags: [Public]
      summary: Request case study PDF generation
      description: |
        Queues an asynchronous PDF generation job for the specified case study.
        Returns a job ID that can be polled via `/public/pdf-jobs/{id}`.
      security: []
      parameters:
        - name: slug
          in: path
          required: true
          schema: { type: string }
          description: URL slug of the case study
          example: greenfield-school-success
      responses:
        '202':
          description: PDF generation job queued
          content:
            application/json:
              schema:
                type: object
                properties:
                  job_id: { type: string, format: uuid }
                  status: { type: string, example: queued }
  
  /public/pdf-jobs/{id}:
    get:
      operationId: publicGetPdfJobStatus
      tags: [Public]
      summary: Check PDF generation job status
      description: |
        Returns the current status of an asynchronous PDF generation job.
        Poll this endpoint until `status` becomes `completed` or `failed`.
      security: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
          description: Job ID returned from the PDF creation endpoint
      responses:
        '200':
          description: Job status
          content:
            application/json:
              schema:
                type: object
                properties:
                  id: { type: string, format: uuid }
                  status: { type: string, enum: [queued, processing, completed, failed] }
                  created_at: { type: string, format: date-time }
  
  /public/pdf-jobs/{id}/download:
    get:
      operationId: publicDownloadPdfJob
      tags: [Public]
      summary: Download completed PDF
      description: |
        Downloads the generated PDF file. Only available when the job `status`
        is `completed`. Returns 404 if job doesn't exist or isn't ready.
      security: []
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: PDF file download
          content:
            application/pdf:
              schema:
                type: string
                format: binary
        '404':
          description: Job not found or not yet completed
  
  /public/admissions/enquiry:
    post:
      operationId: publicSubmitAdmissionEnquiry
      tags: [Public]
      summary: Submit an admission enquiry
      description: |
        Allows parents/guardians to submit an admission enquiry from the school's
        public website. Optionally requires a CAPTCHA token (skipped when
        `X-Env: test` header is present). The enquiry is visible to admissions
        staff via the admin panel.
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [student_name, class_applied, parent_name, phone]
              properties:
                student_name:
                  type: string
                  description: Full name of the student
                  example: "Aarav Sharma"
                class_applied:
                  type: string
                  description: Class/grade being applied for
                  example: "Class 5"
                parent_name:
                  type: string
                  description: Parent/guardian's full name
                  example: "Sanjay Sharma"
                phone:
                  type: string
                  description: Contact phone number
                  example: "+919876543210"
                email:
                  type: string
                  format: email
                  description: Parent's email address
                captcha:
                  type: string
                  description: CAPTCHA verification token (if required)
      responses:
        '201':
          description: Admission enquiry created
          content:
            application/json:
              schema:
                type: object
                properties:
                  id: { type: string, format: uuid }
                  status: { type: string, example: new }
        '400':
          description: Missing required fields or CAPTCHA validation failed

  # from paths/students.yaml
  # Students, Academic Structure, Student 360, Custom Fields, Houses, Hostel, ID Cards, Promotion paths
  
  /admin/students:
    get:
      operationId: listStudents
      tags: [Students]
      summary: List students with filtering and pagination
      description: |
        Returns a paginated list of students for the tenant. Supports searching
        by name/admission number and filtering by class/section.
      parameters:
        - name: limit
          in: query
          schema: { type: integer, default: 50, maximum: 200 }
          description: Maximum number of results to return
        - name: offset
          in: query
          schema: { type: integer, default: 0 }
          description: Number of results to skip (for pagination)
        - name: search
          in: query
          schema: { type: string }
          description: Search by student name or admission number
        - name: class_id
          in: query
          schema: { type: string, format: uuid }
          description: Filter by class ID
        - name: section_id
          in: query
          schema: { type: string, format: uuid }
          description: Filter by section ID
        - name: status
          in: query
          schema: { type: string, enum: [active, inactive, alumni] }
          description: Filter by student status
      responses:
        '200':
          description: Paginated student list
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id: { type: string, format: uuid }
                        admission_number: { type: string, example: "2025/001" }
                        first_name: { type: string }
                        last_name: { type: string }
                        class_name: { type: string, example: "Class 5" }
                        section_name: { type: string, example: "A" }
                        status: { type: string, enum: [active, inactive, alumni] }
                        photo_url: { type: string, format: uri }
                  total: { type: integer, description: Total matching records }
    post:
      operationId: createStudent
      tags: [Students]
      summary: Create a new student
      description: |
        Creates a new student record. The student is assigned an admission number
        (auto-generated if not provided), linked to a class and section, and
        optionally populated with additional fields like date of birth and gender.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [first_name, last_name, class_id, section_id]
              properties:
                first_name: { type: string, example: "Ananya" }
                last_name: { type: string, example: "Verma" }
                admission_number: { type: string, description: Auto-generated if omitted }
                class_id: { type: string, format: uuid }
                section_id: { type: string, format: uuid }
                date_of_birth: { type: string, format: date, example: "2015-05-12" }
                gender: { type: string, enum: [male, female, other] }
                phone: { type: string }
                address: { type: string }
                photo_url: { type: string, format: uri }
      responses:
        '201':
          description: Student created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id: { type: string, format: uuid }
                  admission_number: { type: string }
  
  /admin/students/{id}:
    get:
      operationId: getStudent
      tags: [Students]
      summary: Get student details
      description: Returns complete student profile including class, section, guardians, and custom fields.
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
          description: Student ID
      responses:
        '200':
          description: Student detail
          content:
            application/json:
              schema:
                type: object
                properties:
                  id: { type: string, format: uuid }
                  admission_number: { type: string }
                  first_name: { type: string }
                  last_name: { type: string }
                  date_of_birth: { type: string, format: date }
                  gender: { type: string }
                  class_id: { type: string, format: uuid }
                  class_name: { type: string }
                  section_id: { type: string, format: uuid }
                  section_name: { type: string }
                  status: { type: string }
                  photo_url: { type: string }
                  guardians: { type: array, items: { type: object } }
                  custom_fields: { type: object, additionalProperties: true }
        '404':
          description: Student not found
    put:
      operationId: updateStudent
      tags: [Students]
      summary: Update student details
      description: Updates any editable fields on the student record. Partial updates are supported.
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                first_name: { type: string }
                last_name: { type: string }
                class_id: { type: string, format: uuid }
                section_id: { type: string, format: uuid }
                date_of_birth: { type: string, format: date }
                gender: { type: string }
                status: { type: string, enum: [active, inactive] }
      responses:
        '200':
          description: Student updated
    delete:
      operationId: deleteStudent
      tags: [Students]
      summary: Delete (soft-delete) a student
      description: Marks the student as deleted. Data is retained for audit purposes.
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Student deleted
  
  /admin/students/{id}/guardians:
    get:
      operationId: listStudentGuardians
      tags: [Students]
      summary: List guardians for a student
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Guardian list
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id: { type: string, format: uuid }
                    name: { type: string }
                    relation: { type: string, example: "Father" }
                    phone: { type: string }
                    email: { type: string, format: email }
                    is_primary: { type: boolean }
    post:
      operationId: addStudentGuardian
      tags: [Students]
      summary: Add a guardian to a student
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, phone, relation]
              properties:
                name: { type: string }
                phone: { type: string }
                relation: { type: string, description: "Relationship to student", example: "Mother" }
                email: { type: string, format: email }
                is_primary: { type: boolean, default: false }
      responses:
        '201':
          description: Guardian added
  
  /admin/students/import:
    post:
      operationId: importStudents
      tags: [Students]
      summary: Bulk import students from CSV/Excel
      description: |
        Accepts a CSV or Excel file with student data and creates records in bulk.
        Returns the import job ID for tracking progress. Duplicate admission
        numbers are reported as errors.
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required: [file]
              properties:
                file:
                  type: string
                  format: binary
                  description: CSV or Excel file with student data
      responses:
        '200':
          description: Import job created
          content:
            application/json:
              schema:
                type: object
                properties:
                  job_id: { type: string, format: uuid }
                  total_rows: { type: integer }
                  created: { type: integer }
                  errors: { type: integer }
  
  # ─── Academic Structure ──────────────────────────────
  /admin/academic-structure/academic-years:
    get:
      operationId: listAcademicYears
      tags: [Academic Structure]
      summary: List academic years
      description: Returns all academic years configured for the tenant, ordered by start date.
      responses:
        '200':
          description: Academic year list
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id: { type: string, format: uuid }
                    name: { type: string, example: "2025-26" }
                    start_date: { type: string, format: date }
                    end_date: { type: string, format: date }
                    is_current: { type: boolean }
    post:
      operationId: createAcademicYear
      tags: [Academic Structure]
      summary: Create a new academic year
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, start_date, end_date]
              properties:
                name: { type: string, example: "2026-27" }
                start_date: { type: string, format: date }
                end_date: { type: string, format: date }
      responses:
        '201':
          description: Academic year created
  
  /admin/academic-structure/classes:
    get:
      operationId: listClasses
      tags: [Academic Structure]
      summary: List all classes
      responses:
        '200':
          description: Class list with IDs and display order
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id: { type: string, format: uuid }
                    name: { type: string, example: "Class 5" }
                    display_order: { type: integer }
    post:
      operationId: createClass
      tags: [Academic Structure]
      summary: Create a new class
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name: { type: string }
                display_order: { type: integer }
      responses:
        '201':
          description: Class created
  
  /admin/academic-structure/classes/{classID}/sections:
    get:
      operationId: listSectionsByClass
      tags: [Academic Structure]
      summary: List sections for a class
      parameters:
        - name: classID
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Section list
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id: { type: string, format: uuid }
                    name: { type: string, example: "A" }
                    student_count: { type: integer }
    post:
      operationId: createSection
      tags: [Academic Structure]
      summary: Create a section in a class
      parameters:
        - name: classID
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name: { type: string, example: "B" }
      responses:
        '201':
          description: Section created
  
  /admin/academic-structure/subjects:
    get:
      operationId: listSubjects
      tags: [Academic Structure]
      summary: List all subjects
      responses:
        '200':
          description: Subject list
    post:
      operationId: createSubject
      tags: [Academic Structure]
      summary: Create a subject
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, code]
              properties:
                name: { type: string, example: "Mathematics" }
                code: { type: string, example: "MATH" }
      responses:
        '201':
          description: Subject created
  
  # ─── Student 360 ────────────────────────────────────
  /admin/students/{id}/360:
    get:
      operationId: getStudent360
      tags: [Student 360]
      summary: Get holistic student view
      description: |
        Returns a comprehensive 360° view of a student including academic
        performance, attendance trends, behavioral records, health info,
        and financial standing — all in one response.
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Full student 360 data
  
  /admin/students/{id}/360/behavior:
    get:
      operationId: listBehavioralLogs
      tags: [Student 360]
      summary: List behavioral logs for a student
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Behavioral log entries
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id: { type: string, format: uuid }
                    type: { type: string, enum: [positive, negative, neutral] }
                    description: { type: string }
                    date: { type: string, format: date }
                    recorded_by: { type: string }
    post:
      operationId: addBehavioralLog
      tags: [Student 360]
      summary: Add a behavioral log entry
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [type, description]
              properties:
                type: { type: string, enum: [positive, negative, neutral] }
                description: { type: string }
                date: { type: string, format: date }
      responses:
        '201':
          description: Log entry added
  
  /admin/students/{id}/360/health:
    get:
      operationId: getHealthRecord
      tags: [Student 360]
      summary: Get student health record
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Health record
          content:
            application/json:
              schema:
                type: object
                properties:
                  blood_group: { type: string, example: "B+" }
                  allergies: { type: string }
                  medical_conditions: { type: string }
                  emergency_contact: { type: string }
    post:
      operationId: upsertHealthRecord
      tags: [Student 360]
      summary: Create/update health record
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                blood_group: { type: string }
                allergies: { type: string }
                medical_conditions: { type: string }
                emergency_contact: { type: string }
      responses:
        '200':
          description: Health record saved
  
  /admin/students/{id}/360/documents:
    get:
      operationId: listStudentDocuments
      tags: [Student 360]
      summary: List student documents
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Document list
    post:
      operationId: uploadStudentDocument
      tags: [Student 360]
      summary: Upload student document
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file: { type: string, format: binary }
                type: { type: string, description: "Document type (aadhar, birth_certificate, etc.)" }
      responses:
        '201':
          description: Document uploaded
  
  /admin/students/{id}/360/export:
    get:
      operationId: exportStudentPortfolioPdf
      tags: [Student 360]
      summary: Export student portfolio as PDF
      description: Generates and downloads a comprehensive PDF portfolio for the student.
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: PDF file download
          content:
            application/pdf:
              schema:
                type: string
                format: binary
  
  # ─── Confidential Notes ─────────────
  /admin/students/{id}/confidential-notes:
    get:
      operationId: listConfidentialNotes
      tags: [Confidential Notes]
      summary: List confidential notes for a student
      description: Returns notes only visible to authorized staff (not shared with parents/students).
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Notes list
    post:
      operationId: addConfidentialNote
      tags: [Confidential Notes]
      summary: Add a confidential note
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [content]
              properties:
                content: { type: string, description: Note content (Markdown supported) }
      responses:
        '201':
          description: Note added
  
  /admin/students/{id}/confidential-notes/{noteId}:
    delete:
      operationId: deleteConfidentialNote
      tags: [Confidential Notes]
      summary: Delete a confidential note
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
        - name: noteId
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Note deleted
  
  # ─── Custom Fields ───────────────────
  /admin/custom-fields/definitions:
    get:
      operationId: listCustomFieldDefinitions
      tags: [Custom Fields]
      summary: List custom field definitions
      description: Returns all custom field definitions configured for the tenant.
      responses:
        '200':
          description: Definitions list
    post:
      operationId: createCustomFieldDefinition
      tags: [Custom Fields]
      summary: Create a custom field definition
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, field_type, entity_type]
              properties:
                name: { type: string, example: "Father's Occupation" }
                field_type: { type: string, enum: [text, number, date, select, checkbox, textarea] }
                entity_type: { type: string, description: "Entity this field applies to", example: "student" }
                options: { type: array, items: { type: string }, description: "For select/checkbox types" }
                is_required: { type: boolean, default: false }
      responses:
        '201':
          description: Definition created
  
  /admin/custom-fields/definitions/{id}:
    put:
      operationId: updateCustomFieldDefinition
      tags: [Custom Fields]
      summary: Update a custom field definition
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name: { type: string }
                options: { type: array, items: { type: string } }
                is_required: { type: boolean }
      responses:
        '200':
          description: Updated
    delete:
      operationId: deleteCustomFieldDefinition
      tags: [Custom Fields]
      summary: Delete a custom field definition
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Deleted
  
  /admin/custom-fields/values/{entityType}/{entityId}:
    get:
      operationId: getCustomFieldValues
      tags: [Custom Fields]
      summary: Get custom field values for an entity
      parameters:
        - name: entityType
          in: path
          required: true
          schema: { type: string }
          description: Entity type (e.g. "student", "employee")
        - name: entityId
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Key-value map of custom field values
  
  /admin/custom-fields/values/{entityId}:
    put:
      operationId: setCustomFieldValues
      tags: [Custom Fields]
      summary: Set custom field values for an entity
      parameters:
        - name: entityId
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              additionalProperties: true
              description: Map of field_id to value
      responses:
        '200':
          description: Values saved
  
  # ─── Houses ──────────────────────────
  /admin/houses:
    get:
      operationId: listHouses
      tags: [Houses]
      summary: List student houses
      responses:
        '200':
          description: House list
    post:
      operationId: createHouse
      tags: [Houses]
      summary: Create a new house
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name: { type: string, example: "Blue Eagles" }
                color: { type: string, example: "#1E88E5" }
      responses:
        '201':
          description: Created
  
  /admin/houses/{id}:
    put:
      operationId: updateHouse
      tags: [Houses]
      summary: Update a house
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name: { type: string }
                color: { type: string }
      responses:
        '200':
          description: Updated
    delete:
      operationId: deleteHouse
      tags: [Houses]
      summary: Delete a house
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Deleted
  
  /admin/houses/assign/{studentId}:
    post:
      operationId: assignStudentHouse
      tags: [Houses]
      summary: Assign a student to a house
      parameters:
        - name: studentId
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [house_id]
              properties:
                house_id: { type: string, format: uuid }
      responses:
        '200':
          description: Student assigned to house
  
  # ─── School Profile ──────────────────
  /admin/school-profile:
    get:
      operationId: getSchoolProfile
      tags: [School Profile]
      summary: Get school profile
      responses:
        '200':
          description: School profile settings
    put:
      operationId: updateSchoolProfile
      tags: [School Profile]
      summary: Update school profile
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name: { type: string }
                address: { type: string }
                phone: { type: string }
                email: { type: string, format: email }
                logo_url: { type: string, format: uri }
                website: { type: string, format: uri }
      responses:
        '200':
          description: Profile updated
  
  /admin/import-jobs:
    get:
      operationId: listImportJobs
      tags: [Students]
      summary: List import jobs
      description: Returns the status and results of all CSV/Excel import jobs.
      responses:
        '200':
          description: Import job list
  
  # ─── ID Cards ────────────────────────
  /admin/id-cards/templates:
    get:
      operationId: listIdCardTemplates
      tags: [ID Cards]
      summary: List ID card templates
      responses:
        '200':
          description: Template list
    post:
      operationId: createIdCardTemplate
      tags: [ID Cards]
      summary: Create an ID card template
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, layout]
              properties:
                name: { type: string }
                layout: { type: object, description: JSON layout definition }
      responses:
        '201':
          description: Template created
  
  /admin/id-cards/templates/{id}:
    delete:
      operationId: deleteIdCardTemplate
      tags: [ID Cards]
      summary: Delete an ID card template
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Deleted
  
  # ─── Hostel ──────────────────────────
  /admin/hostel/buildings:
    get:
      operationId: listHostelBuildings
      tags: [Hostel]
      summary: List hostel buildings
      responses:
        '200':
          description: Building list
    post:
      operationId: createHostelBuilding
      tags: [Hostel]
      summary: Create a hostel building
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name: { type: string }
                capacity: { type: integer }
                type: { type: string, enum: [boys, girls, mixed] }
      responses:
        '201':
          description: Building created
  
  /admin/hostel/buildings/{buildingId}/rooms:
    get:
      operationId: listHostelRooms
      tags: [Hostel]
      summary: List rooms in a building
      parameters:
        - name: buildingId
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Room list
    post:
      operationId: createHostelRoom
      tags: [Hostel]
      summary: Create a room
      parameters:
        - name: buildingId
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [room_number]
              properties:
                room_number: { type: string }
                capacity: { type: integer }
                floor: { type: integer }
      responses:
        '201':
          description: Room created
  
  /admin/hostel/allocations:
    get:
      operationId: listHostelAllocations
      tags: [Hostel]
      summary: List hostel allocations
      responses:
        '200':
          description: Allocation list
    post:
      operationId: allocateHostelRoom
      tags: [Hostel]
      summary: Allocate a room to a student
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [student_id, room_id]
              properties:
                student_id: { type: string, format: uuid }
                room_id: { type: string, format: uuid }
      responses:
        '201':
          description: Room allocated
  
  /admin/hostel/allocations/{id}/vacate:
    post:
      operationId: vacateHostelRoom
      tags: [Hostel]
      summary: Vacate a room allocation
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
          description: Allocation ID
      responses:
        '200':
          description: Room vacated
  
  # ─── Promotion ───────────────────────
  /admin/promotion/rules:
    post:
      operationId: createPromotionRule
      tags: [Promotion]
      summary: Create a promotion rule
      description: Defines criteria for automatically promoting students to the next class.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name: { type: string }
                from_class_id: { type: string, format: uuid }
                to_class_id: { type: string, format: uuid }
                criteria: { type: object, description: "Promotion criteria (min attendance, min marks, etc.)" }
      responses:
        '201':
          description: Rule created
  
  /admin/promotion/apply:
    post:
      operationId: applyPromotion
      tags: [Promotion]
      summary: Execute student promotion
      description: |
        Applies the specified promotion rule to a section, moving qualifying
        students to the next class. Returns counts of promoted and failed students.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [rule_id, section_id]
              properties:
                rule_id: { type: string, format: uuid }
                section_id: { type: string, format: uuid }
      responses:
        '200':
          description: Promotion results
          content:
            application/json:
              schema:
                type: object
                properties:
                  promoted: { type: integer }
                  failed: { type: integer }
                  skipped: { type: integer }

  # from paths/dashboard.yaml
  # Dashboard & Biometric API Paths
  # Based on dashboard handler: GetDailyCommandStatus, GetStrategicAnalytics
  # Based on biometric handler: device management, attendance logs, sync
  
  /admin/dashboard/command-status:
    get:
      operationId: getDailyCommandStatus
      tags: [Dashboard]
      summary: Get real-time daily command status
      description: |
        Returns a comprehensive real-time overview of today's operational metrics
        for the tenant. Includes attendance counts (students and staff), finance
        collections for today, active substitutions, and security status.
  
        This powers the admin dashboard's "Command Status" panel.
      responses:
        '200':
          description: Real-time operational status
          content:
            application/json:
              schema:
                type: object
                properties:
                  attendance:
                    type: object
                    properties:
                      students:
                        type: object
                        properties:
                          present: { type: integer, description: Students marked present today }
                          absent: { type: integer, description: Students marked absent today }
                          late: { type: integer, description: Students marked late today }
                          total: { type: integer, description: Total attendance entries today }
                      staff:
                        type: object
                        properties:
                          present: { type: integer }
                          absent: { type: integer }
                          total: { type: integer }
                  finance:
                    type: object
                    properties:
                      collected_today: { type: integer, format: int64, description: Amount collected today in paise }
                      target_month: { type: integer, format: int64, description: Monthly collection target }
                      pending_dues: { type: integer, format: int64, description: Total pending dues }
                  academics:
                    type: object
                    properties:
                      active_substitutions: { type: integer, description: Number of active teacher substitutions }
                      pending_absences: { type: integer, description: Teacher absences without substitution }
                  security:
                    type: object
                    properties:
                      active_visitors: { type: integer, description: Current visitors on campus }
                      recent_alerts: { type: integer, description: Alerts in last 24 hours }
  
  /admin/dashboard/strategic-analytics:
    get:
      operationId: getStrategicAnalytics
      tags: [Dashboard]
      summary: Get strategic analytics for the dashboard
      description: |
        Returns aggregated analytics data for the principal/admin dashboard.
        Includes:
        - **Academic heatmap**: Average scores by class and subject
        - **Financial collection**: Monthly collection amounts (last 6 months)
        - **Admission funnel**: Application counts by status
      responses:
        '200':
          description: Strategic analytics data
          content:
            application/json:
              schema:
                type: object
                properties:
                  academic_heatmap:
                    type: array
                    description: Average scores per class per subject
                    items:
                      type: object
                      properties:
                        class_name: { type: string, example: "Class 10" }
                        subject_name: { type: string, example: "Mathematics" }
                        average_score: { type: number, format: double, example: 78.5 }
                  financial_collection:
                    type: array
                    description: Monthly fee collection totals (last 6 months)
                    items:
                      type: object
                      properties:
                        month: { type: string, example: "Jan 2026" }
                        amount: { type: integer, format: int64, example: 1250000 }
                  admission_funnel:
                    type: array
                    description: Count of admission applications by stage
                    items:
                      type: object
                      properties:
                        status: { type: string, enum: [enquiry, applied, under_review, accepted, enrolled, rejected] }
                        count: { type: integer, example: 45 }
  
  /admin/biometric/devices:
    get:
      operationId: listBiometricDevices
      tags: [Biometric]
      summary: List registered biometric devices
      description: |
        Returns all biometric devices registered for the tenant. Each device has
        a serial number, name, location, and active status.
      responses:
        '200':
          description: Device list
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id: { type: string, format: uuid }
                    name: { type: string, example: "Main Gate Scanner" }
                    serial_number: { type: string }
                    location: { type: string, example: "Main Entrance" }
                    is_active: { type: boolean }
                    last_sync_at: { type: string, format: date-time }
    post:
      operationId: registerBiometricDevice
      tags: [Biometric]
      summary: Register a new biometric device
      description: |
        Registers a new fingerprint/face recognition device for attendance tracking.
        The device must have a unique serial number within the tenant.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, serial_number]
              properties:
                name: { type: string, description: Human-readable device name }
                serial_number: { type: string, description: Manufacturer serial number }
                location: { type: string, description: Physical location of the device }
      responses:
        '201':
          description: Device registered
          content:
            application/json:
              schema:
                type: object
                properties:
                  id: { type: string, format: uuid }
                  name: { type: string }
  
  /admin/biometric/devices/{id}:
    put:
      operationId: updateBiometricDevice
      tags: [Biometric]
      summary: Update biometric device configuration
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
          description: Device ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name: { type: string }
                location: { type: string }
                is_active: { type: boolean, description: Set false to disable syncing }
      responses:
        '200':
          description: Device updated
  
  /admin/biometric/attendance-logs:
    get:
      operationId: listBiometricAttendanceLogs
      tags: [Biometric]
      summary: List raw biometric attendance logs
      description: |
        Returns raw punch-in/punch-out logs from biometric devices.
        Can be filtered by date and device ID.
      parameters:
        - name: date
          in: query
          schema: { type: string, format: date }
          description: Filter by date (defaults to today)
        - name: device_id
          in: query
          schema: { type: string, format: uuid }
          description: Filter by specific device
        - name: limit
          in: query
          schema: { type: integer, default: 100, maximum: 500 }
        - name: offset
          in: query
          schema: { type: integer, default: 0 }
      responses:
        '200':
          description: Attendance log entries
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id: { type: string, format: uuid }
                    device_id: { type: string, format: uuid }
                    user_identifier: { type: string, description: Fingerprint/face ID from device }
                    punch_type: { type: string, enum: [in, out] }
                    timestamp: { type: string, format: date-time }
  
  /admin/biometric/sync:
    post:
      operationId: syncBiometricData
      tags: [Biometric]
      summary: Trigger biometric data sync
      description: |
        Manually triggers a sync with the specified biometric device.
        Pulls pending attendance records from the device and processes them
        into the attendance system.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [device_id]
              properties:
                device_id:
                  type: string
                  format: uuid
                  description: ID of the device to sync
      responses:
        '200':
          description: Sync initiated
          content:
            application/json:
              schema:
                type: object
                properties:
                  synced_records: { type: integer, description: Number of records imported }
                  status: { type: string, example: completed }

  # from paths/attendance.yaml
  # Attendance API Paths
  
  /admin/attendance/mark:
    post:
      operationId: markStudentAttendance
      tags: [Attendance]
      summary: Mark student attendance for a section
      description: |
        Records attendance for multiple students in a section for a given date.
        Each record specifies the student ID and their status. If attendance
        for the same section/date already exists, it is overwritten.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [section_id, date, records]
              properties:
                section_id:
                  type: string
                  format: uuid
                  description: ID of the class section
                date:
                  type: string
                  format: date
                  description: Attendance date (YYYY-MM-DD)
                  example: "2026-02-20"
                records:
                  type: array
                  description: Attendance entries for each student
                  items:
                    type: object
                    required: [student_id, status]
                    properties:
                      student_id: { type: string, format: uuid }
                      status:
                        type: string
                        enum: [present, absent, late, half_day]
                        description: Attendance status
                      remark:
                        type: string
                        description: Optional remark (e.g., reason for absence)
      responses:
        '200':
          description: Attendance marked successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  marked: { type: integer, description: Number of records saved }
  
  /admin/attendance/list:
    get:
      operationId: listStudentAttendance
      tags: [Attendance]
      summary: List student attendance records
      description: |
        Retrieves attendance records filtered by section, date, or individual
        student. Returns one row per student per session.
      parameters:
        - name: section_id
          in: query
          required: true
          schema: { type: string, format: uuid }
          description: Class section ID
        - name: date
          in: query
          schema: { type: string, format: date }
          description: Specific date to query (defaults to today)
        - name: student_id
          in: query
          schema: { type: string, format: uuid }
          description: Filter by a specific student
      responses:
        '200':
          description: Attendance records
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    student_id: { type: string, format: uuid }
                    student_name: { type: string }
                    admission_number: { type: string }
                    status: { type: string, enum: [present, absent, late, half_day] }
                    remark: { type: string }
                    marked_at: { type: string, format: date-time }
  
  /admin/attendance/report:
    get:
      operationId: getStudentAttendanceReport
      tags: [Attendance]
      summary: Generate attendance report
      description: |
        Returns an aggregated attendance report for a section over a date range.
        Includes total days, present count, absent count, and percentage per student.
      parameters:
        - name: section_id
          in: query
          required: true
          schema: { type: string, format: uuid }
        - name: from
          in: query
          required: true
          schema: { type: string, format: date }
          description: Start date (inclusive)
        - name: to
          in: query
          required: true
          schema: { type: string, format: date }
          description: End date (inclusive)
      responses:
        '200':
          description: Attendance report
          content:
            application/json:
              schema:
                type: object
                properties:
                  section_id: { type: string, format: uuid }
                  from: { type: string, format: date }
                  to: { type: string, format: date }
                  total_days: { type: integer }
                  students:
                    type: array
                    items:
                      type: object
                      properties:
                        student_id: { type: string, format: uuid }
                        name: { type: string }
                        present: { type: integer }
                        absent: { type: integer }
                        late: { type: integer }
                        percentage: { type: number, format: double, example: 92.5 }
  
  /admin/attendance/staff/mark:
    post:
      operationId: markStaffAttendance
      tags: [Attendance]
      summary: Mark staff attendance
      description: |
        Records daily attendance for staff members. Typically done by HR or
        synced from biometric devices.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [date, records]
              properties:
                date: { type: string, format: date }
                records:
                  type: array
                  items:
                    type: object
                    required: [staff_id, status]
                    properties:
                      staff_id: { type: string, format: uuid }
                      status: { type: string, enum: [present, absent, half_day, leave] }
                      remark: { type: string }
      responses:
        '200':
          description: Staff attendance marked
          content:
            application/json:
              schema:
                type: object
                properties:
                  marked: { type: integer }
  
  /admin/attendance/staff/list:
    get:
      operationId: listStaffAttendance
      tags: [Attendance]
      summary: List staff attendance records
      parameters:
        - name: date
          in: query
          schema: { type: string, format: date }
          description: Filter by date (defaults to today)
      responses:
        '200':
          description: Staff attendance records
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    staff_id: { type: string, format: uuid }
                    name: { type: string }
                    status: { type: string }
                    remark: { type: string }
  
  /admin/attendance/staff/report:
    get:
      operationId: getStaffAttendanceReport
      tags: [Attendance]
      summary: Generate staff attendance report
      parameters:
        - name: from
          in: query
          required: true
          schema: { type: string, format: date }
        - name: to
          in: query
          required: true
          schema: { type: string, format: date }
      responses:
        '200':
          description: Staff attendance report with aggregates per staff member
          content:
            application/json:
              schema:
                type: object
                properties:
                  from: { type: string, format: date }
                  to: { type: string, format: date }
                  total_days: { type: integer }
                  staff:
                    type: array
                    items:
                      type: object
                      properties:
                        staff_id: { type: string, format: uuid }
                        name: { type: string }
                        present: { type: integer }
                        absent: { type: integer }
                        percentage: { type: number, format: double }

  # from paths/finance.yaml
  # Finance API Paths — Fee heads, plans, payments, receipts, reports
  
  /admin/finance/fees/heads:
    get:
      operationId: listFeeHeads
      tags: [Finance]
      summary: List fee heads
      description: |
        Returns all fee heads configured for the tenant. Fee heads are categories
        like Tuition Fee, Transport Fee, Lab Fee, etc.
      responses:
        '200':
          description: Fee heads list
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id: { type: string, format: uuid }
                    name: { type: string, example: "Tuition Fee" }
                    type: { type: string, example: "tuition" }
                    is_optional: { type: boolean }
    post:
      operationId: createFeeHead
      tags: [Finance]
      summary: Create a fee head
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, type]
              properties:
                name: { type: string, example: "Lab Fee" }
                type: { type: string, description: "Fee category type" }
                is_optional: { type: boolean, default: false }
      responses:
        '200':
          description: Fee head created
  
  /admin/finance/fees/plans:
    post:
      operationId: createFeePlan
      tags: [Finance]
      summary: Create a fee plan
      description: |
        Creates a fee plan with installment breakdowns for an academic year.
        A fee plan groups multiple fee heads with amounts and due dates.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, academic_year_id, total_amount]
              properties:
                name: { type: string, example: "Class 5 Annual Plan 2025-26" }
                academic_year_id: { type: string, format: uuid }
                total_amount: { type: integer, format: int64, example: 75000, description: "Amount in paise" }
                installments:
                  type: array
                  items:
                    type: object
                    properties:
                      due_date: { type: string, format: date }
                      amount: { type: integer, format: int64 }
      responses:
        '200':
          description: Fee plan created
  
  /admin/finance/fees/assign:
    post:
      operationId: assignFeePlan
      tags: [Finance]
      summary: Assign a fee plan to a student
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [student_id, plan_id]
              properties:
                student_id: { type: string, format: uuid }
                plan_id: { type: string, format: uuid }
      responses:
        '200':
          description: Fee plan assigned to student
  
  /admin/finance/fees/structure:
    get:
      operationId: listFeeStructure
      tags: [Finance]
      summary: List fee class configurations
      description: Returns fee structure breakdown by class and academic year.
      responses:
        '200':
          description: Fee structure list
    post:
      operationId: upsertFeeStructure
      tags: [Finance]
      summary: Create or update fee class configuration
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [class_id, academic_year_id, components]
              properties:
                class_id: { type: string, format: uuid }
                academic_year_id: { type: string, format: uuid }
                components:
                  type: array
                  items:
                    type: object
                    properties:
                      fee_head_id: { type: string, format: uuid }
                      amount: { type: integer, format: int64 }
      responses:
        '200':
          description: Fee structure saved
  
  /admin/finance/fees/gateways:
    get:
      operationId: getPaymentGatewayConfig
      tags: [Finance]
      summary: Get active payment gateway configuration
      responses:
        '200':
          description: Gateway config (keys are masked)
    post:
      operationId: upsertPaymentGatewayConfig
      tags: [Finance]
      summary: Configure payment gateway (Razorpay/PayU/Cashfree)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [gateway, key_id, key_secret]
              properties:
                gateway: { type: string, enum: [razorpay, payu, cashfree] }
                key_id: { type: string }
                key_secret: { type: string }
                webhook_secret: { type: string }
      responses:
        '200':
          description: Config saved
  
  /admin/finance/fees/scholarships:
    get:
      operationId: listScholarships
      tags: [Finance]
      summary: List scholarships
      parameters:
        - name: active_only
          in: query
          schema: { type: boolean }
      responses:
        '200':
          description: Scholarship list
    post:
      operationId: upsertScholarship
      tags: [Finance]
      summary: Create or update a scholarship
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, type, value]
              properties:
                name: { type: string, example: "Merit Scholarship" }
                type: { type: string, enum: [percentage, fixed] }
                value: { type: number, example: 25, description: "25% or ₹25000 depending on type" }
                criteria: { type: object, description: "Eligibility criteria" }
      responses:
        '200':
          description: Scholarship saved
  
  /admin/finance/fees/optional:
    get:
      operationId: listOptionalFeeItems
      tags: [Finance]
      summary: List optional fee items
      description: Fee items that students can opt into (e.g., swimming, music class).
      responses:
        '200':
          description: Optional fee items
  
  /admin/finance/fees/select:
    post:
      operationId: selectOptionalFee
      tags: [Finance]
      summary: Opt a student into an optional fee
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [student_id, fee_item_id]
              properties:
                student_id: { type: string, format: uuid }
                fee_item_id: { type: string, format: uuid }
      responses:
        '200':
          description: Optional fee selected
  
  /admin/finance/fees/students/{id}/summary:
    get:
      operationId: getStudentFeeSummary
      tags: [Finance]
      summary: Get fee summary for a student
      description: |
        Returns total fees, amount paid, pending dues, and overdue amounts
        for a specific student.
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
          description: Student ID
      responses:
        '200':
          description: Fee summary
          content:
            application/json:
              schema:
                type: object
                properties:
                  total: { type: integer, format: int64, description: "Total fees in paise" }
                  paid: { type: integer, format: int64 }
                  pending: { type: integer, format: int64 }
                  overdue: { type: integer, format: int64 }
                  next_due_date: { type: string, format: date }
  
  /admin/finance/fees/late-fees:
    get:
      operationId: listLateFeeRules
      tags: [Finance]
      summary: List late fee rules
      responses:
        '200':
          description: Late fee rules
    post:
      operationId: createLateFeeRule
      tags: [Finance]
      summary: Create a late fee rule
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name: { type: string }
                type: { type: string, enum: [fixed, percentage, per_day] }
                value: { type: number }
                grace_days: { type: integer, description: "Days after due date before late fee applies" }
      responses:
        '200':
          description: Rule created
  
  /admin/finance/fees/concessions:
    get:
      operationId: listConcessionRules
      tags: [Finance]
      summary: List fee concession rules
      responses:
        '200':
          description: Concession rules
    post:
      operationId: createConcessionRule
      tags: [Finance]
      summary: Create a fee concession rule
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, type, value]
              properties:
                name: { type: string, example: "Sibling Discount" }
                type: { type: string, enum: [percentage, fixed] }
                value: { type: number }
      responses:
        '200':
          description: Rule created
  
  /admin/finance/fees/fee-reminders:
    get:
      operationId: listFeeReminderConfigs
      tags: [Finance]
      summary: List fee reminder configurations
      responses:
        '200':
          description: Reminder configs
    post:
      operationId: upsertFeeReminderConfig
      tags: [Finance]
      summary: Create or update fee reminder configuration
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                days_before: { type: integer, description: "Days before due date to send reminder" }
                channel: { type: string, enum: [sms, email, push, whatsapp] }
                template: { type: string, description: "Message template with variables" }
      responses:
        '200':
          description: Config saved
  
  /admin/finance/student-concessions:
    post:
      operationId: applyStudentConcession
      tags: [Finance]
      summary: Apply a concession to a student
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [student_id, concession_id]
              properties:
                student_id: { type: string, format: uuid }
                concession_id: { type: string, format: uuid }
      responses:
        '200':
          description: Concession applied
  
  /admin/finance/payments/offline:
    post:
      operationId: issueOfflineReceipt
      tags: [Finance]
      summary: Issue an offline payment receipt
      description: |
        Records a payment received via cash, cheque, DD, or bank transfer.
        Generates a receipt number from the active receipt series and marks
        the corresponding fee components as paid.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [student_id, amount, mode]
              properties:
                student_id: { type: string, format: uuid }
                amount: { type: integer, format: int64, description: "Amount in paise" }
                mode: { type: string, enum: [cash, cheque, dd, bank_transfer] }
                reference: { type: string, description: "Cheque/DD number or bank reference" }
                components:
                  type: array
                  description: Fee head-wise breakup of the payment
                  items:
                    type: object
                    properties:
                      fee_head_id: { type: string, format: uuid }
                      amount: { type: integer, format: int64 }
      responses:
        '200':
          description: Receipt issued
          content:
            application/json:
              schema:
                type: object
                properties:
                  receipt_id: { type: string, format: uuid }
                  receipt_number: { type: string }
  
  /admin/finance/payments/receipts:
    get:
      operationId: listReceipts
      tags: [Finance]
      summary: List payment receipts
      parameters:
        - name: student_id
          in: query
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Receipt list
  
  /admin/finance/payments/reports/billing:
    get:
      operationId: getBillingReport
      tags: [Finance]
      summary: Get billing report
      description: Generates a class-wise billing report for a date range.
      parameters:
        - name: from
          in: query
          required: true
          schema: { type: string, format: date }
        - name: to
          in: query
          required: true
          schema: { type: string, format: date }
        - name: class_id
          in: query
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Billing report
  
  /admin/finance/payments/reports/collections:
    get:
      operationId: getCollectionsReport
      tags: [Finance]
      summary: Get collections report
      parameters:
        - name: from
          in: query
          required: true
          schema: { type: string, format: date }
        - name: to
          in: query
          required: true
          schema: { type: string, format: date }
      responses:
        '200':
          description: Collection report
  
  /admin/finance/payments/online:
    post:
      operationId: createOnlinePaymentOrder
      tags: [Finance]
      summary: Create an online payment order (Razorpay)
      description: |
        Creates a Razorpay order for online fee payment. Returns the order details
        required by the client-side Razorpay checkout widget.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [student_id, amount]
              properties:
                student_id: { type: string, format: uuid }
                amount: { type: integer, format: int64, description: "Amount in paise", example: 2500000 }
      responses:
        '200':
          description: Razorpay order created
          content:
            application/json:
              schema:
                type: object
                properties:
                  order_id: { type: string, format: uuid }
                  razorpay_order_id: { type: string, description: "Razorpay order ID for checkout" }
                  amount: { type: integer, format: int64 }
                  currency: { type: string, example: "INR" }
  
  /admin/finance/payments/razorpay-webhook:
    post:
      operationId: handleRazorpayWebhook
      tags: [Finance]
      summary: Razorpay payment webhook
      description: |
        Handles asynchronous payment status updates from Razorpay.
        Verifies the webhook signature using the configured webhook secret
        and updates the payment status accordingly.
      security: []
      responses:
        '200':
          description: Webhook processed
  
  /admin/finance/payments/tally-export:
    get:
      operationId: exportTallyData
      tags: [Finance]
      summary: Export receipts for Tally accounting software
      description: Downloads a CSV file formatted for Tally import.
      parameters:
        - name: from
          in: query
          required: true
          schema: { type: string, format: date }
        - name: to
          in: query
          required: true
          schema: { type: string, format: date }
      responses:
        '200':
          description: CSV file download
          content:
            text/csv:
              schema:
                type: string
                format: binary
  
  /admin/finance/payments/ledger-mappings:
    get:
      operationId: listLedgerMappings
      tags: [Finance]
      summary: List Tally ledger mappings
      description: Maps fee heads to Tally ledger codes for accounting export.
      responses:
        '200':
          description: Ledger mappings
    post:
      operationId: upsertLedgerMapping
      tags: [Finance]
      summary: Create or update a ledger mapping
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [fee_head_id, ledger_code]
              properties:
                fee_head_id: { type: string, format: uuid }
                ledger_code: { type: string }
      responses:
        '200':
          description: Mapping saved
  
  /admin/finance/receipts/series:
    get:
      operationId: listReceiptSeries
      tags: [Finance]
      summary: List receipt number series
      responses:
        '200':
          description: Receipt series configurations
    post:
      operationId: createReceiptSeries
      tags: [Finance]
      summary: Create a receipt number series
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [prefix, start_number]
              properties:
                prefix: { type: string, example: "REC-2025-" }
                start_number: { type: integer, example: 1001 }
      responses:
        '200':
          description: Series created
  
  /admin/finance/receipts/{id}/cancel:
    post:
      operationId: cancelReceipt
      tags: [Finance]
      summary: Cancel a receipt
      description: Cancels an issued receipt with a mandatory reason. Reverses the payment allocation.
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [reason]
              properties:
                reason: { type: string, description: "Cancellation reason" }
      responses:
        '200':
          description: Receipt cancelled
  
  /admin/finance/receipts/{id}/refund:
    post:
      operationId: createRefund
      tags: [Finance]
      summary: Create a refund against a receipt
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [amount, reason]
              properties:
                amount: { type: integer, format: int64, description: "Refund amount in paise" }
                reason: { type: string }
      responses:
        '200':
          description: Refund created
  
  /admin/finance/receipts/{id}/pdf:
    get:
      operationId: downloadReceiptPdf
      tags: [Finance]
      summary: Download receipt as PDF
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: PDF file download
          content:
            application/pdf:
              schema:
                type: string
                format: binary

  # from paths/exams.yaml
  # Exam API Paths
  
  /admin/exams:
    get:
      operationId: listExams
      tags: [Exams]
      summary: List exams
      description: Returns all exams for the tenant, optionally filtered by academic year.
      parameters:
        - name: academic_year_id
          in: query
          schema: { type: string, format: uuid }
        - name: class_id
          in: query
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Exam list
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id: { type: string, format: uuid }
                    name: { type: string, example: "Mid-Term 2025" }
                    exam_type: { type: string, enum: [mid_term, final, unit_test] }
                    start_date: { type: string, format: date }
                    end_date: { type: string, format: date }
                    is_published: { type: boolean }
    post:
      operationId: createExam
      tags: [Exams]
      summary: Create an exam
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, academic_year_id]
              properties:
                name: { type: string, example: "Mid-Term 2025" }
                academic_year_id: { type: string, format: uuid }
                class_id: { type: string, format: uuid }
                start_date: { type: string, format: date }
                end_date: { type: string, format: date }
                exam_type: { type: string, enum: [mid_term, final, unit_test] }
      responses:
        '201':
          description: Exam created
  
  /admin/exams/{id}:
    get:
      operationId: getExam
      tags: [Exams]
      summary: Get exam details
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Exam detail with subjects and schedule
  
  /admin/exams/{id}/subjects:
    get:
      operationId: listExamSubjects
      tags: [Exams]
      summary: List subjects in an exam
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Subject list with max marks and dates
    post:
      operationId: addExamSubject
      tags: [Exams]
      summary: Add a subject to an exam
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [subject_id, max_marks]
              properties:
                subject_id: { type: string, format: uuid }
                max_marks: { type: number, example: 100 }
                passing_marks: { type: number, example: 33 }
                date: { type: string, format: date }
      responses:
        '201':
          description: Subject added
  
  /admin/exams/{id}/subjects/{subjectId}/metadata:
    post:
      operationId: updateExamSubjectMetadata
      tags: [Exams]
      summary: Update exam subject metadata
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
        - name: subjectId
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                max_marks: { type: number }
                passing_marks: { type: number }
      responses:
        '200':
          description: Metadata updated
  
  /admin/exams/{id}/subjects/{subjectId}/marks:
    get:
      operationId: getExamMarks
      tags: [Exams]
      summary: Get marks for an exam subject
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
        - name: subjectId
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Student marks list
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    student_id: { type: string, format: uuid }
                    student_name: { type: string }
                    marks: { type: number }
                    grade: { type: string }
    post:
      operationId: upsertExamMarks
      tags: [Exams]
      summary: Enter or update marks for a student
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
        - name: subjectId
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [student_id, marks]
              properties:
                student_id: { type: string, format: uuid }
                marks: { type: number }
      responses:
        '200':
          description: Marks saved
  
  /admin/exams/{id}/subjects/{subjectId}/marks/bulk:
    post:
      operationId: bulkUpsertExamMarks
      tags: [Exams]
      summary: Bulk enter marks for multiple students
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
        - name: subjectId
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                type: object
                required: [student_id, marks]
                properties:
                  student_id: { type: string, format: uuid }
                  marks: { type: number }
      responses:
        '200':
          description: Marks saved for all students
  
  /admin/exams/{id}/publish:
    post:
      operationId: publishExamResults
      tags: [Exams]
      summary: Publish exam results
      description: Makes exam results visible to parents and students.
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Results published
  
  /admin/exams/{id}/hall-tickets:
    get:
      operationId: listHallTickets
      tags: [Exams]
      summary: List hall tickets for an exam
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Hall ticket list
    post:
      operationId: generateHallTickets
      tags: [Exams]
      summary: Generate hall tickets for an exam
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Hall tickets generated
  
  /admin/exams/{id}/hall-tickets/{studentId}/pdf:
    get:
      operationId: downloadHallTicketPdf
      tags: [Exams]
      summary: Download hall ticket PDF for a student
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
        - name: studentId
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: PDF download
          content:
            application/pdf:
              schema:
                type: string
                format: binary
  
  /admin/exams/grading/scales:
    post:
      operationId: upsertGradingScale
      tags: [Exams]
      summary: Create or update a grading scale
      description: Defines grade-to-marks mapping (e.g., A+ = 90-100, A = 80-89).
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, grades]
              properties:
                name: { type: string, example: "CBSE Standard" }
                grades:
                  type: array
                  items:
                    type: object
                    properties:
                      grade: { type: string, example: "A+" }
                      min_marks: { type: number }
                      max_marks: { type: number }
      responses:
        '200':
          description: Grading scale saved
  
  /admin/exams/grading/weights:
    post:
      operationId: upsertExamWeight
      tags: [Exams]
      summary: Set exam type weighting
      description: Assigns weights to exam types for aggregate calculation (e.g., Mid-Term 30%, Final 70%).
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [exam_type, weight]
              properties:
                exam_type: { type: string }
                weight: { type: number, example: 0.3 }
      responses:
        '200':
          description: Weight saved
  
  /admin/exams/grading/initialize:
    post:
      operationId: initializeGradingTemplate
      tags: [Exams]
      summary: Apply a predefined grading template
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                template: { type: string, enum: [cbse, icse, state_board] }
      responses:
        '200':
          description: Template applied
  
  /admin/exams/aggregates/calculate:
    post:
      operationId: calculateAggregates
      tags: [Exams]
      summary: Calculate weighted aggregate scores
      description: Computes weighted aggregates across all exams for a class in an academic year.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [academic_year_id, class_id]
              properties:
                academic_year_id: { type: string, format: uuid }
                class_id: { type: string, format: uuid }
      responses:
        '200':
          description: Aggregates calculated
  
  /admin/exams/questions:
    get:
      operationId: listQuestions
      tags: [Exams]
      summary: List question bank questions
      parameters:
        - name: subject_id
          in: query
          schema: { type: string, format: uuid }
        - name: difficulty
          in: query
          schema: { type: string, enum: [easy, medium, hard] }
        - name: type
          in: query
          schema: { type: string, enum: [mcq, short_answer, long_answer, fill_blank] }
      responses:
        '200':
          description: Question list
    post:
      operationId: createQuestion
      tags: [Exams]
      summary: Add a question to the bank
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [subject_id, question_text, question_type, marks]
              properties:
                subject_id: { type: string, format: uuid }
                question_text: { type: string }
                question_type: { type: string, enum: [mcq, short_answer, long_answer, fill_blank] }
                marks: { type: number }
                difficulty: { type: string, enum: [easy, medium, hard] }
                options:
                  type: array
                  description: For MCQ questions
                  items:
                    type: object
                    properties:
                      text: { type: string }
                      is_correct: { type: boolean }
      responses:
        '201':
          description: Question created
  
  /admin/exams/papers:
    get:
      operationId: listQuestionPapers
      tags: [Exams]
      summary: List question papers
      responses:
        '200':
          description: Paper list
    post:
      operationId: createQuestionPaper
      tags: [Exams]
      summary: Create a question paper
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, subject_id, question_ids]
              properties:
                name: { type: string }
                subject_id: { type: string, format: uuid }
                question_ids: { type: array, items: { type: string, format: uuid } }
      responses:
        '201':
          description: Paper created
  
  /admin/exams/papers/{id}:
    get:
      operationId: getQuestionPaper
      tags: [Exams]
      summary: Get question paper with full questions
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Paper detail with questions
  
  /admin/exams/papers/generate:
    post:
      operationId: autoGenerateQuestionPaper
      tags: [Exams]
      summary: Auto-generate a question paper
      description: |
        Automatically selects questions from the bank based on difficulty mix,
        total marks, and subject constraints.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [subject_id, total_marks]
              properties:
                subject_id: { type: string, format: uuid }
                total_marks: { type: number, example: 100 }
                difficulty_mix:
                  type: object
                  properties:
                    easy: { type: number, description: "Percentage", example: 30 }
                    medium: { type: number, example: 50 }
                    hard: { type: number, example: 20 }
      responses:
        '200':
          description: Paper generated with selected questions

  # from paths/notices.yaml
  # Notices & Notifications API Paths
  
  /admin/notices:
    get:
      operationId: listNotices
      tags: [Notices]
      summary: List notices and circulars
      description: Returns notices for the tenant with filtering by status and audience.
      parameters:
        - name: status
          in: query
          schema: { type: string, enum: [draft, published, archived] }
        - name: audience
          in: query
          schema: { type: string, enum: [all, parents, teachers, students, staff] }
        - name: limit
          in: query
          schema: { type: integer, default: 50 }
        - name: offset
          in: query
          schema: { type: integer, default: 0 }
      responses:
        '200':
          description: Notice list
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id: { type: string, format: uuid }
                    title: { type: string }
                    content: { type: string }
                    status: { type: string }
                    audience: { type: string }
                    published_at: { type: string, format: date-time }
    post:
      operationId: createNotice
      tags: [Notices]
      summary: Create a notice (as draft)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [title, content]
              properties:
                title: { type: string, example: "Annual Day Celebration" }
                content: { type: string, description: "Markdown-formatted content" }
                audience: { type: string, enum: [all, parents, teachers, students, staff], default: all }
                attachments: { type: array, items: { type: string, format: uri } }
      responses:
        '201':
          description: Notice created as draft
  
  /admin/notices/{id}:
    get:
      operationId: getNotice
      tags: [Notices]
      summary: Get notice detail
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Notice detail
    put:
      operationId: updateNotice
      tags: [Notices]
      summary: Update a notice
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title: { type: string }
                content: { type: string }
                audience: { type: string }
      responses:
        '200':
          description: Notice updated
    delete:
      operationId: deleteNotice
      tags: [Notices]
      summary: Delete a notice
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Notice deleted
  
  /admin/notices/{id}/publish:
    post:
      operationId: publishNotice
      tags: [Notices]
      summary: Publish a notice
      description: Changes notice status from draft to published and sends notifications.
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Notice published
  
  /admin/notifications/send:
    post:
      operationId: sendNotification
      tags: [Notifications]
      summary: Send a notification to users
      description: |
        Sends a notification via push, SMS, email, or WhatsApp to specified
        recipients or target groups.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [title, body, channel]
              properties:
                title: { type: string }
                body: { type: string }
                channel: { type: string, enum: [push, sms, email, whatsapp] }
                recipients:
                  type: array
                  items: { type: string, format: uuid }
                  description: Specific user IDs (optional if target_group is set)
                target_group:
                  type: string
                  enum: [all_parents, all_teachers, all_staff, class]
      responses:
        '200':
          description: Notification sent
          content:
            application/json:
              schema:
                type: object
                properties:
                  sent_count: { type: integer }
                  failed_count: { type: integer }
  
  /admin/notifications/logs:
    get:
      operationId: listNotificationLogs
      tags: [Notifications]
      summary: List notification delivery logs
      parameters:
        - name: channel
          in: query
          schema: { type: string, enum: [push, sms, email, whatsapp] }
        - name: from
          in: query
          schema: { type: string, format: date }
        - name: to
          in: query
          schema: { type: string, format: date }
      responses:
        '200':
          description: Delivery logs
  
  /admin/notifications/templates:
    get:
      operationId: listNotificationTemplates
      tags: [Notifications]
      summary: List notification templates
      responses:
        '200':
          description: Template list
    post:
      operationId: createNotificationTemplate
      tags: [Notifications]
      summary: Create a notification template
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, channel, body]
              properties:
                name: { type: string, example: "fee_reminder" }
                channel: { type: string, enum: [push, sms, email, whatsapp] }
                subject: { type: string, description: "For email templates" }
                body: { type: string, description: "Template body with {{variables}}" }
      responses:
        '201':
          description: Template created
  
  /admin/notifications/templates/{id}:
    put:
      operationId: updateNotificationTemplate
      tags: [Notifications]
      summary: Update a notification template
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name: { type: string }
                body: { type: string }
      responses:
        '200':
          description: Template updated
    delete:
      operationId: deleteNotificationTemplate
      tags: [Notifications]
      summary: Delete a notification template
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Template deleted

  # from paths/communication.yaml
  # Communication & CRM API Paths — WhatsApp, Email, SMS configurations and logs
  
  /admin/communication/whatsapp/config:
    get:
      operationId: getWhatsAppConfig
      tags: [Communication]
      summary: Get WhatsApp API configuration
      responses:
        '200':
          description: WhatsApp settings
    post:
      operationId: updateWhatsAppConfig
      tags: [Communication]
      summary: Update WhatsApp API settings
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [provider, api_key]
              properties:
                provider: { type: string, enum: [meta, twilio, gupshup] }
                api_key: { type: string }
                phone_number_id: { type: string }
      responses:
        '200':
          description: Config updated
  
  /admin/communication/broadcast:
    post:
      operationId: sendBroadcast
      tags: [Communication]
      summary: Send multi-channel broadcast
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [channels, message, targets]
              properties:
                channels: { type: array, items: { type: string, enum: [sms, email, whatsapp, push] } }
                message: { type: string }
                targets: { type: object, description: "Filter criteria for recipients" }
      responses:
        '200':
          description: Broadcast initiated
  
  /admin/communication/logs:
    get:
      operationId: listCommunicationLogs
      tags: [Communication]
      summary: List communication logs
      parameters:
        - name: channel
          in: query
          schema: { type: string }
      responses:
        '200':
          description: Log list
  
  /admin/communication/templates:
    get:
      operationId: listCommTemplates
      tags: [Communication]
      summary: List message templates
      responses:
        '200':
          description: Template list
    post:
      operationId: createCommTemplate
      tags: [Communication]
      summary: Create message template
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, body]
              properties:
                name: { type: string }
                body: { type: string }
                variables: { type: array, items: { type: string } }
      responses:
        '201':
          description: Template created

  # from paths/academics.yaml
  # Academics API Paths — Homework, Lesson Plans, Timetable, Certificates, Calendar, Resources
  
  /admin/academics/homework:
    get:
      operationId: listHomework
      tags: [Academics]
      summary: List homework assignments
      parameters:
        - name: class_id
          in: query
          schema: { type: string, format: uuid }
        - name: subject_id
          in: query
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Homework list
    post:
      operationId: createHomework
      tags: [Academics]
      summary: Create a homework assignment
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [title, section_id, subject_id, due_date]
              properties:
                title: { type: string }
                description: { type: string }
                section_id: { type: string, format: uuid }
                subject_id: { type: string, format: uuid }
                due_date: { type: string, format: date }
                attachments: { type: array, items: { type: string, format: uri } }
      responses:
        '201':
          description: Homework created
  
  /admin/academics/homework/options:
    get:
      operationId: getHomeworkOptions
      tags: [Academics]
      summary: Get homework creation options (classes, sections, subjects)
      responses:
        '200':
          description: Options for dropdown menus
  
  /admin/academics/homework/section/{sectionId}:
    get:
      operationId: listHomeworkBySection
      tags: [Academics]
      summary: List homework for a specific section
      parameters:
        - name: sectionId
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Homework list for section
  
  /admin/academics/homework/{id}/submissions:
    get:
      operationId: listHomeworkSubmissions
      tags: [Academics]
      summary: List student submissions for a homework
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Submission list with student names and status
  
  /admin/academics/homework/submissions/{id}/grade:
    post:
      operationId: gradeHomeworkSubmission
      tags: [Academics]
      summary: Grade a homework submission
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
          description: Submission ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                grade: { type: string }
                feedback: { type: string }
                score: { type: number }
      responses:
        '200':
          description: Submission graded
  
  /admin/academics/lesson-plans:
    get:
      operationId: listLessonPlans
      tags: [Academics]
      summary: List lesson plans
      parameters:
        - name: subject_id
          in: query
          schema: { type: string, format: uuid }
        - name: teacher_id
          in: query
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Lesson plan list
    post:
      operationId: createLessonPlan
      tags: [Academics]
      summary: Create a lesson plan
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [title, subject_id]
              properties:
                title: { type: string }
                subject_id: { type: string, format: uuid }
                class_id: { type: string, format: uuid }
                section_id: { type: string, format: uuid }
                content: { type: string, description: "Plan content (Markdown)" }
                scheduled_date: { type: string, format: date }
      responses:
        '201':
          description: Lesson plan created
  
  /admin/academics/lesson-plans/lag:
    get:
      operationId: getLessonPlanLag
      tags: [Academics]
      summary: Get lesson plan lag report
      description: Shows which lesson plans are behind schedule or incomplete.
      responses:
        '200':
          description: Lag report
  
  /admin/academics/lesson-plans/{id}/status:
    put:
      operationId: updateLessonPlanStatus
      tags: [Academics]
      summary: Update lesson plan status
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [status]
              properties:
                status: { type: string, enum: [draft, approved, completed, overdue] }
      responses:
        '200':
          description: Status updated
  
  /admin/academics/subjects:
    get:
      operationId: listAcademicSubjects
      tags: [Academics]
      summary: List subjects with section assignments
      responses:
        '200':
          description: Subject list
  
  /admin/academics/timetable:
    get:
      operationId: getAcademicTimetable
      tags: [Academics]
      summary: Get timetable for a class/section
      parameters:
        - name: section_id
          in: query
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Timetable grid
  
  /admin/academics/certificates/requests:
    get:
      operationId: listCertificateRequests
      tags: [Academics]
      summary: List certificate requests
      description: Returns pending TC, character certificate, and bonafide requests.
      responses:
        '200':
          description: Certificate request list
    post:
      operationId: createCertificateRequest
      tags: [Academics]
      summary: Create a certificate request
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [student_id, type]
              properties:
                student_id: { type: string, format: uuid }
                type: { type: string, enum: [transfer, character, bonafide, study] }
                reason: { type: string }
      responses:
        '201':
          description: Request created
  
  /admin/academics/certificates/requests/{id}/status:
    put:
      operationId: updateCertificateRequestStatus
      tags: [Academics]
      summary: Approve or reject a certificate request
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [status]
              properties:
                status: { type: string, enum: [approved, rejected, issued] }
      responses:
        '200':
          description: Status updated
  
  /admin/academics/calendar:
    get:
      operationId: getAcademicCalendar
      tags: [Academics]
      summary: Get academic calendar (combined events and holidays)
      parameters:
        - name: month
          in: query
          schema: { type: integer, minimum: 1, maximum: 12 }
        - name: year
          in: query
          schema: { type: integer }
      responses:
        '200':
          description: Calendar with events and holidays
  
  /admin/calendar/events:
    get:
      operationId: listCalendarEvents
      tags: [Calendar]
      summary: List calendar events
      parameters:
        - name: from
          in: query
          schema: { type: string, format: date }
        - name: to
          in: query
          schema: { type: string, format: date }
      responses:
        '200':
          description: Event list
    post:
      operationId: createCalendarEvent
      tags: [Calendar]
      summary: Create a calendar event
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [title, start_date]
              properties:
                title: { type: string }
                description: { type: string }
                start_date: { type: string, format: date-time }
                end_date: { type: string, format: date-time }
                event_type: { type: string, enum: [academic, sports, cultural, meeting, other] }
                audience: { type: string }
      responses:
        '201':
          description: Event created
  
  /admin/calendar/events/{id}:
    put:
      operationId: updateCalendarEvent
      tags: [Calendar]
      summary: Update a calendar event
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title: { type: string }
                description: { type: string }
                start_date: { type: string, format: date-time }
                end_date: { type: string, format: date-time }
      responses:
        '200':
          description: Event updated
    delete:
      operationId: deleteCalendarEvent
      tags: [Calendar]
      summary: Delete a calendar event
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Event deleted
  
  /admin/calendar/holidays:
    get:
      operationId: listHolidays
      tags: [Calendar]
      summary: List holidays
      responses:
        '200':
          description: Holiday list
    post:
      operationId: createHoliday
      tags: [Calendar]
      summary: Create a holiday
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, date]
              properties:
                name: { type: string, example: "Republic Day" }
                date: { type: string, format: date }
                is_optional: { type: boolean, default: false }
      responses:
        '201':
          description: Holiday created
  
  /admin/calendar/holidays/{id}:
    delete:
      operationId: deleteHoliday
      tags: [Calendar]
      summary: Delete a holiday
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Holiday deleted
  
  /admin/resources:
    get:
      operationId: listResources
      tags: [Resources]
      summary: List teaching resources
      parameters:
        - name: subject_id
          in: query
          schema: { type: string, format: uuid }
        - name: type
          in: query
          schema: { type: string, enum: [document, video, link, file] }
      responses:
        '200':
          description: Resource list
    post:
      operationId: createResource
      tags: [Resources]
      summary: Upload a teaching resource
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [title, type]
              properties:
                title: { type: string }
                description: { type: string }
                type: { type: string, enum: [document, video, link, file] }
                url: { type: string, format: uri }
                subject_id: { type: string, format: uuid }
      responses:
        '201':
          description: Resource created
  
  /admin/resources/{id}:
    delete:
      operationId: deleteResource
      tags: [Resources]
      summary: Delete a teaching resource
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Resource deleted

  # from paths/schedule.yaml
  # Schedule API Paths — Timetable, Periods, Substitutions, Teacher Specializations
  
  /admin/schedule/variants:
    get:
      operationId: listScheduleVariants
      tags: [Schedule]
      summary: List timetable variants
      description: |
        Returns timetable variants (e.g., Regular, Exam Day, Half Day).
        Each variant has a different period structure.
      responses:
        '200':
          description: Variant list
    post:
      operationId: createScheduleVariant
      tags: [Schedule]
      summary: Create a timetable variant
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name: { type: string, example: "Regular" }
                is_default: { type: boolean }
      responses:
        '201':
          description: Variant created
  
  /admin/schedule/teacher-daily:
    get:
      operationId: getTeacherDailySchedule
      tags: [Schedule]
      summary: Get a teacher's daily schedule
      parameters:
        - name: teacher_id
          in: query
          required: true
          schema: { type: string, format: uuid }
        - name: date
          in: query
          schema: { type: string, format: date }
      responses:
        '200':
          description: Teacher's schedule for the day
  
  /admin/schedule/periods/{variantID}:
    get:
      operationId: listPeriodsByVariant
      tags: [Schedule]
      summary: List periods for a timetable variant
      parameters:
        - name: variantID
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Period list with start/end times
  
  /admin/schedule/periods:
    post:
      operationId: createPeriod
      tags: [Schedule]
      summary: Create a period slot
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [variant_id, name, start_time, end_time]
              properties:
                variant_id: { type: string, format: uuid }
                name: { type: string, example: "Period 1" }
                start_time: { type: string, example: "08:30" }
                end_time: { type: string, example: "09:15" }
                is_break: { type: boolean, default: false }
      responses:
        '201':
          description: Period created
  
  /admin/schedule/timetable:
    get:
      operationId: getTimetableEntries
      tags: [Schedule]
      summary: Get timetable entries for a section
      parameters:
        - name: section_id
          in: query
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Timetable grid
    post:
      operationId: upsertTimetableEntry
      tags: [Schedule]
      summary: Create or update a timetable entry
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [section_id, period_id, day, subject_id, teacher_id]
              properties:
                section_id: { type: string, format: uuid }
                period_id: { type: string, format: uuid }
                day: { type: integer, minimum: 0, maximum: 6, description: "0=Monday" }
                subject_id: { type: string, format: uuid }
                teacher_id: { type: string, format: uuid }
      responses:
        '200':
          description: Entry saved
  
  /admin/schedule/substitutions:
    get:
      operationId: listSubstitutions
      tags: [Schedule]
      summary: List teacher substitutions
      parameters:
        - name: date
          in: query
          schema: { type: string, format: date }
      responses:
        '200':
          description: Substitution list
    post:
      operationId: createSubstitution
      tags: [Schedule]
      summary: Create a teacher substitution
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [timetable_entry_id, substitute_teacher_id, date]
              properties:
                timetable_entry_id: { type: string, format: uuid }
                substitute_teacher_id: { type: string, format: uuid }
                date: { type: string, format: date }
                reason: { type: string }
      responses:
        '201':
          description: Substitution created
  
  /admin/schedule/substitutions/free-teachers:
    get:
      operationId: listFreeTeachers
      tags: [Schedule]
      summary: List available teachers for substitution
      description: Teachers who have free periods at a specific time.
      parameters:
        - name: date
          in: query
          required: true
          schema: { type: string, format: date }
        - name: period_id
          in: query
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Free teacher list
  
  /admin/schedule/substitutions/absences:
    get:
      operationId: listTeacherAbsences
      tags: [Schedule]
      summary: List recorded teacher absences
      parameters:
        - name: date
          in: query
          schema: { type: string, format: date }
      responses:
        '200':
          description: Absence list
    post:
      operationId: recordTeacherAbsence
      tags: [Schedule]
      summary: Record a teacher absence
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [teacher_id, absence_date]
              properties:
                teacher_id: { type: string, format: uuid }
                absence_date: { type: string, format: date }
                reason: { type: string }
      responses:
        '201':
          description: Absence recorded
  
  /admin/schedule/substitutions/teacher-lessons/{teacherID}:
    get:
      operationId: getTeacherLessons
      tags: [Schedule]
      summary: Get a teacher's lessons for a date
      parameters:
        - name: teacherID
          in: path
          required: true
          schema: { type: string, format: uuid }
        - name: date
          in: query
          schema: { type: string, format: date }
      responses:
        '200':
          description: Lesson list for the teacher
  
  /admin/schedule/teachers/specializations:
    get:
      operationId: listTeacherSpecializations
      tags: [Schedule]
      summary: List all teacher-subject specializations
      responses:
        '200':
          description: Teacher specialization list
    post:
      operationId: addTeacherSpecialization
      tags: [Schedule]
      summary: Add a subject specialization for a teacher
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [teacher_id, subject_id]
              properties:
                teacher_id: { type: string, format: uuid }
                subject_id: { type: string, format: uuid }
      responses:
        '201':
          description: Specialization added
  
  /admin/schedule/teachers/specializations/{teacherID}:
    get:
      operationId: getTeacherSpecializations
      tags: [Schedule]
      summary: Get specializations for a specific teacher
      parameters:
        - name: teacherID
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Subject specializations for the teacher
  
  /admin/schedule/teachers/class-teacher:
    get:
      operationId: listClassTeacherAssignments
      tags: [Schedule]
      summary: List class teacher assignments
      responses:
        '200':
          description: Class teacher mapping
    post:
      operationId: assignClassTeacher
      tags: [Schedule]
      summary: Assign a class teacher to a section
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [teacher_id, section_id]
              properties:
                teacher_id: { type: string, format: uuid }
                section_id: { type: string, format: uuid }
      responses:
        '200':
          description: Class teacher assigned

  # from paths/transport.yaml
  # Transport API Paths
  
  /admin/transport/vehicles:
    get:
      operationId: listVehicles
      tags: [Transport]
      summary: List transport vehicles
      responses:
        '200':
          description: Vehicle list
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id: { type: string, format: uuid }
                    registration_number: { type: string, example: "RJ14 AB 1234" }
                    type: { type: string, enum: [bus, van, auto] }
                    capacity: { type: integer }
                    is_active: { type: boolean }
    post:
      operationId: createVehicle
      tags: [Transport]
      summary: Register a vehicle
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [registration_number, type, capacity]
              properties:
                registration_number: { type: string }
                type: { type: string, enum: [bus, van, auto] }
                capacity: { type: integer }
                make: { type: string }
                model: { type: string }
      responses:
        '201':
          description: Vehicle registered
  
  /admin/transport/vehicles/{id}:
    put:
      operationId: updateVehicle
      tags: [Transport]
      summary: Update a vehicle
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                registration_number: { type: string }
                capacity: { type: integer }
                is_active: { type: boolean }
      responses:
        '200':
          description: Vehicle updated
    delete:
      operationId: deleteVehicle
      tags: [Transport]
      summary: Delete a vehicle
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Vehicle deleted
  
  /admin/transport/drivers:
    get:
      operationId: listDrivers
      tags: [Transport]
      summary: List drivers
      responses:
        '200':
          description: Driver list
    post:
      operationId: createDriver
      tags: [Transport]
      summary: Register a driver
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, phone, license_number]
              properties:
                name: { type: string }
                phone: { type: string }
                license_number: { type: string }
                vehicle_id: { type: string, format: uuid }
      responses:
        '201':
          description: Driver registered
  
  /admin/transport/drivers/{id}:
    put:
      operationId: updateDriver
      tags: [Transport]
      summary: Update a driver
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name: { type: string }
                phone: { type: string }
                vehicle_id: { type: string, format: uuid }
                is_active: { type: boolean }
      responses:
        '200':
          description: Driver updated
  
  /admin/transport/routes:
    get:
      operationId: listRoutes
      tags: [Transport]
      summary: List transport routes
      responses:
        '200':
          description: Route list
    post:
      operationId: createRoute
      tags: [Transport]
      summary: Create a transport route
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name: { type: string, example: "Route 1 - North Area" }
                vehicle_id: { type: string, format: uuid }
                driver_id: { type: string, format: uuid }
      responses:
        '201':
          description: Route created
  
  /admin/transport/routes/{id}:
    put:
      operationId: updateRoute
      tags: [Transport]
      summary: Update a route
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name: { type: string }
                vehicle_id: { type: string, format: uuid }
                driver_id: { type: string, format: uuid }
      responses:
        '200':
          description: Route updated
  
  /admin/transport/routes/{id}/stops:
    get:
      operationId: listRouteStops
      tags: [Transport]
      summary: List stops on a route
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Ordered stop list with times
    post:
      operationId: addRouteStop
      tags: [Transport]
      summary: Add a stop to a route
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, pickup_time]
              properties:
                name: { type: string, example: "Vaishali Nagar Gate" }
                pickup_time: { type: string, example: "07:15" }
                drop_time: { type: string, example: "14:45" }
                order: { type: integer }
      responses:
        '201':
          description: Stop added
  
  /admin/transport/allocations:
    get:
      operationId: listTransportAllocations
      tags: [Transport]
      summary: List student-route allocations
      responses:
        '200':
          description: Allocation list
    post:
      operationId: allocateStudentToRoute
      tags: [Transport]
      summary: Allocate a student to a transport route/stop
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [student_id, route_id, stop_id]
              properties:
                student_id: { type: string, format: uuid }
                route_id: { type: string, format: uuid }
                stop_id: { type: string, format: uuid }
      responses:
        '201':
          description: Student allocated
  
  /admin/transport/fuel-logs:
    get:
      operationId: listFuelLogs
      tags: [Transport]
      summary: List fuel consumption logs
      parameters:
        - name: vehicle_id
          in: query
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Fuel log entries
    post:
      operationId: createFuelLog
      tags: [Transport]
      summary: Record a fuel entry
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [vehicle_id, liters, amount]
              properties:
                vehicle_id: { type: string, format: uuid }
                liters: { type: number, example: 45.5 }
                amount: { type: integer, format: int64, description: "Cost in paise" }
                odometer_reading: { type: number }
                date: { type: string, format: date }
      responses:
        '201':
          description: Fuel log recorded
  
  /admin/transport/generate-fees:
    post:
      operationId: generateTransportFees
      tags: [Transport]
      summary: Generate transport fees for allocated students
      description: Creates fee entries based on route allocations.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                academic_year_id: { type: string, format: uuid }
      responses:
        '200':
          description: Fees generated

  # from paths/library.yaml
  # Library API Paths
  
  /admin/library/books:
    get:
      operationId: listBooks
      tags: [Library]
      summary: List library books
      parameters:
        - name: search
          in: query
          schema: { type: string }
          description: Search by title, author, or ISBN
        - name: category_id
          in: query
          schema: { type: string, format: uuid }
        - name: available
          in: query
          schema: { type: boolean }
          description: Filter only available copies
        - name: limit
          in: query
          schema: { type: integer, default: 50 }
        - name: offset
          in: query
          schema: { type: integer, default: 0 }
      responses:
        '200':
          description: Book list
    post:
      operationId: createBook
      tags: [Library]
      summary: Add a book to the library
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [title, isbn]
              properties:
                title: { type: string }
                isbn: { type: string }
                author: { type: string }
                publisher: { type: string }
                category_id: { type: string, format: uuid }
                total_copies: { type: integer }
                shelf_location: { type: string }
      responses:
        '201':
          description: Book added
  
  /admin/library/books/{id}:
    get:
      operationId: getBook
      tags: [Library]
      summary: Get book details
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Book detail
    put:
      operationId: updateBook
      tags: [Library]
      summary: Update book details
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title: { type: string }
                total_copies: { type: integer }
                shelf_location: { type: string }
      responses:
        '200':
          description: Book updated
  
  /admin/library/categories:
    get:
      operationId: listBookCategories
      tags: [Library]
      summary: List book categories
      responses:
        '200':
          description: Category list
    post:
      operationId: createBookCategory
      tags: [Library]
      summary: Create a book category
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name: { type: string, example: "Science Fiction" }
      responses:
        '201':
          description: Category created
  
  /admin/library/authors:
    get:
      operationId: listAuthors
      tags: [Library]
      summary: List book authors
      responses:
        '200':
          description: Author list
  
  /admin/library/issues:
    get:
      operationId: listBookIssues
      tags: [Library]
      summary: List book issues
      parameters:
        - name: student_id
          in: query
          schema: { type: string, format: uuid }
        - name: status
          in: query
          schema: { type: string, enum: [issued, returned, overdue] }
      responses:
        '200':
          description: Issue list
    post:
      operationId: issueBook
      tags: [Library]
      summary: Issue a book to a student
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [book_id, student_id]
              properties:
                book_id: { type: string, format: uuid }
                student_id: { type: string, format: uuid }
                due_date: { type: string, format: date }
      responses:
        '201':
          description: Book issued
  
  /admin/library/issues/scan-issue:
    post:
      operationId: scanIssueBook
      tags: [Library]
      summary: Issue book via barcode scan
      description: Quick issue by scanning book and student barcodes.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [book_barcode, student_barcode]
              properties:
                book_barcode: { type: string }
                student_barcode: { type: string }
      responses:
        '200':
          description: Book issued
  
  /admin/library/issues/scan-return:
    post:
      operationId: scanReturnBook
      tags: [Library]
      summary: Return book via barcode scan
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [book_barcode]
              properties:
                book_barcode: { type: string }
      responses:
        '200':
          description: Book returned
  
  /admin/library/issues/{id}/return:
    post:
      operationId: returnBook
      tags: [Library]
      summary: Return a book by issue ID
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Book returned
  
  /admin/library/books/{book_id}/assets:
    get:
      operationId: listBookAssets
      tags: [Library]
      summary: List digital assets for a book
      parameters:
        - name: book_id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Asset list (PDFs, ePubs, etc.)
    post:
      operationId: addBookAsset
      tags: [Library]
      summary: Add a digital asset to a book
      parameters:
        - name: book_id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [url, type]
              properties:
                url: { type: string, format: uri }
                type: { type: string, enum: [pdf, epub, audio, video] }
                name: { type: string }
      responses:
        '201':
          description: Asset added
  
  /admin/library/assets/{id}:
    delete:
      operationId: deleteBookAsset
      tags: [Library]
      summary: Delete a digital asset
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Asset deleted
  
  /admin/library/reading-progress/recent:
    get:
      operationId: getRecentReadingProgress
      tags: [Library]
      summary: Get recent reading progress across students
      responses:
        '200':
          description: Recent reading progress entries
  
  /admin/library/reading-progress/{studentId}:
    get:
      operationId: getStudentReadingProgress
      tags: [Library]
      summary: Get reading progress for a student
      parameters:
        - name: studentId
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Reading progress for all books
  
  /admin/library/reading-progress:
    post:
      operationId: createReadingProgress
      tags: [Library]
      summary: Start tracking reading progress
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [student_id, book_id]
              properties:
                student_id: { type: string, format: uuid }
                book_id: { type: string, format: uuid }
                pages_read: { type: integer }
                total_pages: { type: integer }
      responses:
        '201':
          description: Progress tracking started
  
  /admin/library/reading-progress/update:
    post:
      operationId: updateReadingProgress
      tags: [Library]
      summary: Update reading progress
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [student_id, book_id, pages_read]
              properties:
                student_id: { type: string, format: uuid }
                book_id: { type: string, format: uuid }
                pages_read: { type: integer }
      responses:
        '200':
          description: Progress updated
  
  /admin/library/reading-progress/velocity/{studentId}/{bookId}:
    get:
      operationId: getReadingVelocity
      tags: [Library]
      summary: Get reading velocity (pages/day) for a student+book
      parameters:
        - name: studentId
          in: path
          required: true
          schema: { type: string, format: uuid }
        - name: bookId
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Reading velocity data
          content:
            application/json:
              schema:
                type: object
                properties:
                  pages_per_day: { type: number, format: double }
                  estimated_completion: { type: string, format: date }

  # from paths/inventory.yaml
  # Inventory API Paths
  
  /admin/inventory/categories:
    get:
      operationId: listInventoryCategories
      tags: [Inventory]
      summary: List inventory categories
      responses:
        '200':
          description: Category list
    post:
      operationId: createInventoryCategory
      tags: [Inventory]
      summary: Create an inventory category
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name: { type: string, example: "Stationery" }
      responses:
        '201':
          description: Category created
  
  /admin/inventory/suppliers:
    get:
      operationId: listSuppliers
      tags: [Inventory]
      summary: List suppliers
      responses:
        '200':
          description: Supplier list
    post:
      operationId: createSupplier
      tags: [Inventory]
      summary: Register a supplier
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, phone]
              properties:
                name: { type: string }
                phone: { type: string }
                email: { type: string, format: email }
                address: { type: string }
                gstin: { type: string }
      responses:
        '201':
          description: Supplier registered
  
  /admin/inventory/suppliers/{id}:
    put:
      operationId: updateSupplier
      tags: [Inventory]
      summary: Update a supplier
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name: { type: string }
                phone: { type: string }
                email: { type: string, format: email }
      responses:
        '200':
          description: Supplier updated
  
  /admin/inventory/items:
    get:
      operationId: listInventoryItems
      tags: [Inventory]
      summary: List inventory items
      parameters:
        - name: category_id
          in: query
          schema: { type: string, format: uuid }
        - name: low_stock
          in: query
          schema: { type: boolean }
          description: Filter items below reorder level
      responses:
        '200':
          description: Item list with stock levels
    post:
      operationId: createInventoryItem
      tags: [Inventory]
      summary: Add an inventory item
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, category_id, unit]
              properties:
                name: { type: string }
                category_id: { type: string, format: uuid }
                unit: { type: string, example: "pcs" }
                reorder_level: { type: integer }
                current_stock: { type: integer }
      responses:
        '201':
          description: Item created
  
  /admin/inventory/items/{id}:
    put:
      operationId: updateInventoryItem
      tags: [Inventory]
      summary: Update an inventory item
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name: { type: string }
                reorder_level: { type: integer }
      responses:
        '200':
          description: Item updated
  
  /admin/inventory/transactions:
    get:
      operationId: listInventoryTransactions
      tags: [Inventory]
      summary: List stock transactions (in/out)
      parameters:
        - name: item_id
          in: query
          schema: { type: string, format: uuid }
        - name: type
          in: query
          schema: { type: string, enum: [in, out, adjustment] }
      responses:
        '200':
          description: Transaction list
    post:
      operationId: createInventoryTransaction
      tags: [Inventory]
      summary: Record a stock transaction
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [item_id, type, quantity]
              properties:
                item_id: { type: string, format: uuid }
                type: { type: string, enum: [in, out, adjustment] }
                quantity: { type: integer }
                remark: { type: string }
      responses:
        '201':
          description: Transaction recorded
  
  /admin/inventory/purchase-orders:
    get:
      operationId: listPurchaseOrders
      tags: [Inventory]
      summary: List purchase orders
      responses:
        '200':
          description: PO list
    post:
      operationId: createPurchaseOrder
      tags: [Inventory]
      summary: Create a purchase order
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [supplier_id, items]
              properties:
                supplier_id: { type: string, format: uuid }
                items:
                  type: array
                  items:
                    type: object
                    properties:
                      item_id: { type: string, format: uuid }
                      quantity: { type: integer }
                      unit_price: { type: integer, format: int64 }
      responses:
        '201':
          description: PO created
  
  /admin/inventory/purchase-orders/{id}/approve:
    post:
      operationId: approvePurchaseOrder
      tags: [Inventory]
      summary: Approve a purchase order
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: PO approved
  
  /admin/inventory/purchase-orders/{id}/receive:
    post:
      operationId: receivePurchaseOrder
      tags: [Inventory]
      summary: Mark a purchase order as received
      description: Updates stock levels for all items in the PO.
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: PO received and stock updated
  
  /admin/inventory/requisitions:
    get:
      operationId: listRequisitions
      tags: [Inventory]
      summary: List inventory requisitions
      responses:
        '200':
          description: Requisition list
    post:
      operationId: createRequisition
      tags: [Inventory]
      summary: Submit an inventory requisition
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [items]
              properties:
                department: { type: string }
                items:
                  type: array
                  items:
                    type: object
                    properties:
                      item_id: { type: string, format: uuid }
                      quantity: { type: integer }
                      reason: { type: string }
      responses:
        '201':
          description: Requisition submitted
  
  /admin/inventory/requisitions/{id}/status:
    put:
      operationId: updateRequisitionStatus
      tags: [Inventory]
      summary: Approve, reject, or fulfill a requisition
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [status]
              properties:
                status: { type: string, enum: [approved, rejected, fulfilled] }
      responses:
        '200':
          description: Status updated

  # from paths/admissions.yaml
  # Admissions API Paths
  
  /admin/admissions/settings/document-types:
    get:
      operationId: listAdmissionDocumentTypes
      tags: [Admissions]
      summary: List required document types for admissions
      responses:
        '200':
          description: Document type list
    post:
      operationId: upsertAdmissionDocumentType
      tags: [Admissions]
      summary: Create or update a required document type
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name: { type: string, example: "Birth Certificate" }
                is_required: { type: boolean, default: true }
      responses:
        '200':
          description: Saved
  
  /admin/admissions/settings/workflow:
    get:
      operationId: getAdmissionWorkflow
      tags: [Admissions]
      summary: Get admission workflow configuration
      responses:
        '200':
          description: Workflow stages and settings
    put:
      operationId: updateAdmissionWorkflow
      tags: [Admissions]
      summary: Update admission workflow configuration
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                stages: { type: array, items: { type: object } }
                auto_assign: { type: boolean }
      responses:
        '200':
          description: Workflow updated
  
  /admin/admissions/enquiries:
    get:
      operationId: listAdmissionEnquiries
      tags: [Admissions]
      summary: List admission enquiries
      parameters:
        - name: status
          in: query
          schema: { type: string, enum: [new, contacted, converted, lost] }
      responses:
        '200':
          description: Enquiry list
    post:
      operationId: createAdmissionEnquiry
      tags: [Admissions]
      summary: Create an admission enquiry (admin)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [student_name, class_applied, parent_name, phone]
              properties:
                student_name: { type: string }
                class_applied: { type: string }
                parent_name: { type: string }
                phone: { type: string }
                email: { type: string, format: email }
                source: { type: string, enum: [walk_in, website, referral, event] }
      responses:
        '201':
          description: Enquiry created
  
  /admin/admissions/enquiries/{id}/status:
    put:
      operationId: updateEnquiryStatus
      tags: [Admissions]
      summary: Update enquiry status
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [status]
              properties:
                status: { type: string, enum: [new, contacted, converted, lost] }
      responses:
        '200':
          description: Status updated
  
  /admin/admissions/applications:
    get:
      operationId: listApplications
      tags: [Admissions]
      summary: List admission applications
      parameters:
        - name: status
          in: query
          schema: { type: string, enum: [submitted, under_review, accepted, rejected, enrolled] }
        - name: class
          in: query
          schema: { type: string }
      responses:
        '200':
          description: Application list
    post:
      operationId: createApplication
      tags: [Admissions]
      summary: Create an admission application
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [student_name, class_applied, parent_name, phone]
              properties:
                student_name: { type: string }
                class_applied: { type: string }
                parent_name: { type: string }
                phone: { type: string }
                email: { type: string, format: email }
      responses:
        '201':
          description: Application created
  
  /admin/admissions/applications/{id}:
    get:
      operationId: getApplication
      tags: [Admissions]
      summary: Get application detail
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Application detail with documents and status history
  
  /admin/admissions/applications/{id}/status:
    put:
      operationId: updateApplicationStatus
      tags: [Admissions]
      summary: Update application status
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [status]
              properties:
                status: { type: string, enum: [under_review, accepted, rejected] }
                remark: { type: string }
      responses:
        '200':
          description: Status updated
  
  /admin/admissions/applications/{id}/accept:
    post:
      operationId: acceptApplication
      tags: [Admissions]
      summary: Accept an application and create student record
      description: Converts the applicant into a student record in the SIS.
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [section_id]
              properties:
                section_id: { type: string, format: uuid, description: "Section to enroll in" }
      responses:
        '200':
          description: Student created
  
  /admin/admissions/applications/{id}/pay-fee:
    post:
      operationId: payAdmissionFee
      tags: [Admissions]
      summary: Record admission fee payment
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [amount, mode]
              properties:
                amount: { type: integer, format: int64 }
                mode: { type: string, enum: [cash, online, cheque] }
      responses:
        '200':
          description: Fee recorded
  
  /admin/admissions/applications/{id}/documents:
    get:
      operationId: listApplicationDocuments
      tags: [Admissions]
      summary: List documents for an application
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Document list
    post:
      operationId: uploadApplicationDocument
      tags: [Admissions]
      summary: Upload a document for an application
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file: { type: string, format: binary }
                type: { type: string }
      responses:
        '201':
          description: Document uploaded
  
  /admin/admissions/applications/{id}/documents/{index}:
    delete:
      operationId: deleteApplicationDocument
      tags: [Admissions]
      summary: Delete an application document
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
        - name: index
          in: path
          required: true
          schema: { type: integer }
          description: Document index (0-based)
      responses:
        '200':
          description: Document deleted

  # from paths/hrms.yaml
  # HRMS API Paths
  
  /admin/hrms/employees:
    get:
      operationId: listEmployees
      tags: [HRMS]
      summary: List employees
      parameters:
        - name: department
          in: query
          schema: { type: string }
        - name: designation
          in: query
          schema: { type: string }
        - name: search
          in: query
          schema: { type: string }
      responses:
        '200':
          description: Employee list
    post:
      operationId: createEmployee
      tags: [HRMS]
      summary: Create an employee record
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, email, department, designation]
              properties:
                name: { type: string }
                email: { type: string, format: email }
                phone: { type: string }
                department: { type: string }
                designation: { type: string }
                date_of_joining: { type: string, format: date }
      responses:
        '201':
          description: Employee created
  
  /admin/hrms/salary-structures:
    get:
      operationId: listSalaryStructures
      tags: [HRMS]
      summary: List salary structures
      responses:
        '200':
          description: Salary structure list
    post:
      operationId: createSalaryStructure
      tags: [HRMS]
      summary: Create a salary structure
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, components]
              properties:
                name: { type: string, example: "Teacher Grade A" }
                components:
                  type: array
                  items:
                    type: object
                    properties:
                      name: { type: string, example: "Basic" }
                      type: { type: string, enum: [earning, deduction] }
                      amount: { type: integer, format: int64 }
                      is_percentage: { type: boolean }
      responses:
        '201':
          description: Structure created
  
  /admin/hrms/payroll-runs:
    get:
      operationId: listPayrollRuns
      tags: [HRMS]
      summary: List payroll runs
      responses:
        '200':
          description: Payroll run list
    post:
      operationId: createPayrollRun
      tags: [HRMS]
      summary: Create a payroll run
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [month, year]
              properties:
                month: { type: integer, minimum: 1, maximum: 12 }
                year: { type: integer }
      responses:
        '201':
          description: Payroll run created (draft)
  
  /admin/hrms/payroll-runs/{id}/execute:
    post:
      operationId: executePayrollRun
      tags: [HRMS]
      summary: Execute a payroll run
      description: Calculates salaries for all employees and generates payslips.
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Payroll executed
  
  /admin/hrms/adjustments:
    post:
      operationId: createPayrollAdjustment
      tags: [HRMS]
      summary: Create a one-time salary adjustment
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [employee_id, type, amount]
              properties:
                employee_id: { type: string, format: uuid }
                type: { type: string, enum: [bonus, deduction, reimbursement] }
                amount: { type: integer, format: int64 }
                reason: { type: string }
      responses:
        '200':
          description: Adjustment created
  
  /admin/hrms/staff/specializations:
    get:
      operationId: listStaffSpecializations
      tags: [HRMS]
      summary: List staff specializations
      responses:
        '200':
          description: Specialization list
  
  /admin/hrms/staff/class-teachers:
    get:
      operationId: listClassTeachers
      tags: [HRMS]
      summary: List class teacher assignments
      responses:
        '200':
          description: Class teacher mapping
  
  /admin/hrms/staff/tasks:
    get:
      operationId: listStaffTasks
      tags: [HRMS]
      summary: List staff tasks
      parameters:
        - name: status
          in: query
          schema: { type: string, enum: [pending, in_progress, completed] }
      responses:
        '200':
          description: Task list
    post:
      operationId: createStaffTask
      tags: [HRMS]
      summary: Assign a task to staff
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [title, assignee_id]
              properties:
                title: { type: string }
                description: { type: string }
                assignee_id: { type: string, format: uuid }
                due_date: { type: string, format: date }
                priority: { type: string, enum: [low, medium, high] }
      responses:
        '201':
          description: Task created

  # from paths/safety.yaml
  # Safety & Security API Paths — Incident logs, Visitor logs, Security alerts, Gate passes
  
  /admin/safety/incidents:
    get:
      operationId: listIncidentLogs
      tags: [Safety]
      summary: List safety incidents
      responses:
        '200':
          description: Incident list
    post:
      operationId: recordIncident
      tags: [Safety]
      summary: Record a safety incident
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [title, type, description, date]
              properties:
                title: { type: string }
                type: { type: string, enum: [injury, fight, damage, theft, other] }
                description: { type: string }
                date: { type: string, format: date-time }
                severity: { type: string, enum: [low, medium, high] }
                involved_students: { type: array, items: { type: string, format: uuid } }
      responses:
        '201':
          description: Incident recorded
  
  /admin/safety/visitors:
    get:
      operationId: listVisitorLogs
      tags: [Safety]
      summary: List visitor logs
      parameters:
        - name: status
          in: query
          schema: { type: string, enum: [active, checkout] }
      responses:
        '200':
          description: Visitor list
    post:
      operationId: recordVisitorEntry
      tags: [Safety]
      summary: Record visitor entry at gate
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, phone, purpose]
              properties:
                name: { type: string }
                phone: { type: string }
                purpose: { type: string }
                target_user_id: { type: string, format: uuid, description: "Person to meet" }
      responses:
        '201':
          description: Entry recorded
  
  /admin/safety/visitors/{id}/checkout:
    post:
      operationId: visitorCheckout
      tags: [Safety]
      summary: Record visitor checkout
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Checkout recorded
  
  /admin/safety/alerts:
    get:
      operationId: listSecurityAlerts
      tags: [Safety]
      summary: List real-time security alerts
      responses:
        '200':
          description: Alert list
  
  /admin/safety/gate-passes:
    get:
      operationId: listGatePasses
      tags: [Safety]
      summary: List student/staff gate passes
      responses:
        '200':
          description: Gate pass list
    post:
      operationId: createGatePass
      tags: [Safety]
      summary: Issue a gate pass
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [user_id, type]
              properties:
                user_id: { type: string, format: uuid }
                type: { type: string, enum: [early_exit, permission] }
                reason: { type: string }
      responses:
        '201':
          description: Gate pass issued

  # from paths/portfolio.yaml
  # Portfolio & Analytics API Paths — Cross-campus analytics, Student portfolios
  
  /admin/portfolio/analytics:
    get:
      operationId: getCampusAnalytics
      tags: [Portfolio]
      summary: Get cross-campus performance analytics
      responses:
        '200':
          description: Analytical data
  
  /admin/portfolio/students/{id}/growth:
    get:
      operationId: getStudentGrowthChart
      tags: [Portfolio]
      summary: Get student academic growth trends
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Growth trend data
  
  /admin/portfolio/achievements:
    get:
      operationId: listSignificantAchievements
      tags: [Portfolio]
      summary: List significant achievements across school
      responses:
        '200':
          description: Achievement list
    post:
      operationId: recordAchievement
      tags: [Portfolio]
      summary: Record a student/staff achievement
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [user_id, title, date]
              properties:
                user_id: { type: string, format: uuid }
                title: { type: string }
                description: { type: string }
                date: { type: string, format: date }
      responses:
        '201':
          description: Achievement recorded

  # from paths/ai.yaml
  # AI API Paths — Code-backed routes
  
  /admin/ai/generate-lesson-plan:
    post:
      operationId: aiGenerateLessonPlanAdmin
      tags: [AI]
      summary: Generate AI lesson plan (admin scope)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [subject, topic]
              properties:
                subject: { type: string }
                topic: { type: string }
                grade: { type: string }
      responses:
        '200':
          description: Lesson plan generated
        '400':
          description: Invalid request
        '403':
          description: AI feature disabled
        '503':
          description: AI service unavailable
  
  /admin/ai/parent-query:
    post:
      operationId: aiParentQueryAdmin
      tags: [AI]
      summary: Ask AI parent-helpdesk question (admin scope)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [query]
              properties:
                query: { type: string }
                context_info: { type: string }
      responses:
        '200':
          description: AI answer returned
        '400':
          description: Invalid request
        '403':
          description: AI feature disabled
        '503':
          description: AI service unavailable
  
  /admin/ai/exams/rubrics/generate:
    post:
      operationId: aiGenerateExamRubricAdmin
      tags: [AI]
      summary: Generate rubric JSON for exams (admin scope)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [subject, title, max_marks]
              properties:
                subject: { type: string }
                title: { type: string }
                grade: { type: string }
                max_marks: { type: integer, minimum: 1 }
      responses:
        '200':
          description: Rubric JSON generated
        '400':
          description: Invalid request
        '403':
          description: AI feature disabled
        '503':
          description: AI service unavailable
  
  /ai/helpdesk:
    post:
      operationId: aiHelpdeskPublic
      tags: [AI]
      summary: Parent helpdesk AI query (public route)
      description: Publicly reachable route; tenant context still required for meaningful responses.
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [query]
              properties:
                query: { type: string }
                context_info: { type: string }
      responses:
        '200':
          description: AI answer returned
        '400':
          description: Invalid request or tenant context missing
        '403':
          description: AI feature disabled
  
  /ai/lesson-plan:
    post:
      operationId: aiLessonPlanProtected
      tags: [AI]
      summary: Generate lesson plan (teacher/admin protected route)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [subject, topic]
              properties:
                subject: { type: string }
                topic: { type: string }
                grade: { type: string }
      responses:
        '200':
          description: Lesson plan generated
        '401':
          description: Unauthorized
        '403':
          description: Forbidden (role/feature disabled)

  # from paths/kb.yaml
  # Knowledge Base API Paths
  
  /admin/kb/documents:
    get:
      operationId: kbListDocumentsAdmin
      tags: [Knowledge Base]
      summary: List KB documents (admin)
      parameters:
        - in: query
          name: status
          schema: { type: string }
        - in: query
          name: visibility
          schema: { type: string }
        - in: query
          name: category
          schema: { type: string }
        - in: query
          name: q
          schema: { type: string }
        - in: query
          name: limit
          schema: { type: integer, minimum: 0 }
        - in: query
          name: offset
          schema: { type: integer, minimum: 0 }
      responses:
        '200':
          description: KB documents list
    post:
      operationId: kbCreateDocumentAdmin
      tags: [Knowledge Base]
      summary: Create KB document (admin)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '201':
          description: KB document created
        '400':
          description: Invalid payload
  
  /admin/kb/documents/{id}:
    get:
      operationId: kbGetDocumentAdmin
      tags: [Knowledge Base]
      summary: Get KB document by ID (admin)
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: KB document details
        '404':
          description: Not found
    patch:
      operationId: kbUpdateDocumentAdmin
      tags: [Knowledge Base]
      summary: Patch KB document (admin)
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: KB document updated
        '400':
          description: Invalid payload
        '404':
          description: Not found
    delete:
      operationId: kbDeleteDocumentAdmin
      tags: [Knowledge Base]
      summary: Delete KB document (admin)
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string, format: uuid }
      responses:
        '204':
          description: Deleted
        '404':
          description: Not found
  
  /admin/kb/settings:
    get:
      operationId: kbGetSettingsAdmin
      tags: [Knowledge Base]
      summary: Get KB settings (admin)
      responses:
        '200':
          description: KB settings
    patch:
      operationId: kbUpdateSettingsAdmin
      tags: [Knowledge Base]
      summary: Update KB settings (admin)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: KB settings updated
        '400':
          description: Invalid payload
  
  /kb/search:
    post:
      operationId: kbSearchProtected
      tags: [Knowledge Base]
      summary: Search tenant knowledge base (protected)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [query]
              properties:
                query: { type: string }
                top_k: { type: integer, minimum: 1 }
                filters:
                  type: object
                  properties:
                    category: { type: string }
                    tags:
                      type: array
                      items: { type: string }
                    visibility: { type: string }
      responses:
        '200':
          description: Search results
        '400':
          description: Invalid payload
        '403':
          description: Forbidden
  
  /kb/facets:
    get:
      operationId: kbFacetsProtected
      tags: [Knowledge Base]
      summary: List KB search facets (protected)
      responses:
        '200':
          description: Facets response
        '403':
          description: Forbidden

  # from paths/roles.yaml
  # RBAC API Paths — Roles, Permissions, Assignments
  
  /admin/roles:
    get:
      operationId: listRoles
      tags: [Roles]
      summary: List all roles
      responses:
        '200':
          description: Role list
    post:
      operationId: createRole
      tags: [Roles]
      summary: Create a custom role
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, code]
              properties:
                name: { type: string, example: "Library Assistant" }
                code: { type: string, example: "lib_assistant" }
                permissions: { type: array, items: { type: string }, description: "List of permission codes" }
      responses:
        '201':
          description: Role created
  
  /admin/roles/{code}/permissions:
    get:
      operationId: getRolePermissions
      tags: [Roles]
      summary: Get permissions for a role
      parameters:
        - name: code
          in: path
          required: true
          schema: { type: string }
      responses:
        '200':
          description: Permission list
  
  /admin/permissions:
    get:
      operationId: listAllPermissions
      tags: [Roles]
      summary: List all available permissions in the system
      responses:
        '200':
          description: Full permission dictionary
  
  /admin/users/{userId}/roles:
    post:
      operationId: assignUserRole
      tags: [Roles]
      summary: Assign a role to a user
      parameters:
        - name: userId
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [role_code]
              properties:
                role_code: { type: string }
      responses:
        '200':
          description: Role assigned

  # from paths/marketing-admin.yaml
  # Marketing Admin API Paths — Case studies, Reviews, Blog, Leads
  
  /admin/marketing/case-studies:
    get:
      operationId: listCaseStudies
      tags: [Marketing Admin]
      summary: List case studies for management
      responses:
        '200':
          description: Case study list
    post:
      operationId: createCaseStudy
      tags: [Marketing Admin]
      summary: Create a case study
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [title, content]
              properties:
                title: { type: string }
                slug: { type: string }
                content: { type: string }
                school_id: { type: string, format: uuid }
      responses:
        '201':
          description: Case study created
  
  /admin/marketing/reviews:
    get:
      operationId: listPublicReviews
      tags: [Marketing Admin]
      summary: List all public reviews
      responses:
        '200':
          description: Review list
    post:
      operationId: approveReview
      tags: [Marketing Admin]
      summary: Approve a review for public display
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [review_id]
              properties:
                review_id: { type: string, format: uuid }
                is_approved: { type: boolean }
      responses:
        '200':
          description: Review status updated
  
  /admin/marketing/leads:
    get:
      operationId: listLeads
      tags: [Marketing Admin]
      summary: List marketing leads (demo bookings, contact forms)
      responses:
        '200':
          description: Lead list

  # from paths/automation.yaml
  # Automation API Paths — Trigger-action rules
  
  /admin/automation/rules:
    get:
      operationId: listAutomationRules
      tags: [Automation]
      summary: List automation rules
      responses:
        '200':
          description: Rule list
    post:
      operationId: createAutomationRule
      tags: [Automation]
      summary: Create automation rule
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, trigger_type, trigger_event, action_json]
              properties:
                name: { type: string }
                description: { type: string }
                trigger_type: { type: string, enum: [event, time] }
                trigger_event: { type: string }
                schedule_cron: { type: string }
                condition_json: { type: object }
                action_json: { type: object }
                is_active: { type: boolean }
      responses:
        '200':
          description: Rule created
        '400':
          description: Invalid payload
  
  /admin/automation/rules/{id}:
    put:
      operationId: updateAutomationRule
      tags: [Automation]
      summary: Update automation rule
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Rule updated
        '400':
          description: Invalid payload
        '404':
          description: Rule not found
    delete:
      operationId: deleteAutomationRule
      tags: [Automation]
      summary: Delete automation rule
      parameters:
        - in: path
          name: id
          required: true
          schema: { type: string, format: uuid }
      responses:
        '204':
          description: Rule deleted
        '404':
          description: Rule not found

  # from paths/alumni.yaml
  # Alumni API Paths — Former student records, Events, Directory
  
  /admin/alumni:
    get:
      operationId: listAlumni
      tags: [Alumni]
      summary: List alumni
      responses:
        '200':
          description: Alumni list
    post:
      operationId: addAlumnus
      tags: [Alumni]
      summary: Add an alumnus record manually
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, passing_year]
              properties:
                name: { type: string }
                passing_year: { type: integer }
                current_organization: { type: string }
                email: { type: string, format: email }
      responses:
        '201':
          description: Alumnus added
  
  /admin/alumni/events:
    get:
      operationId: listAlumniEvents
      tags: [Alumni]
      summary: List alumni events/reunions
      responses:
        '200':
          description: Event list
    post:
      operationId: createAlumniEvent
      tags: [Alumni]
      summary: Create an alumni event
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [title, date]
              properties:
                title: { type: string }
                date: { type: string, format: date-time }
                location: { type: string }
      responses:
        '201':
          description: Event created

  # from paths/tenant.yaml
  # Tenant Add-ons & Platform Add-on Activation Workflow
  
  /admin/tenants/plugins:
    get:
      operationId: listTenantAddons
      tags: [Tenant Add-ons]
      summary: List tenant add-ons with metadata and current enablement
      responses:
        '200':
          description: Tenant add-ons list
  
  /admin/tenants/plugins/{id}:
    post:
      operationId: updateTenantAddonConfig
      tags: [Tenant Add-ons]
      summary: Update active tenant add-on configuration
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                enabled:
                  type: boolean
                settings:
                  type: object
      responses:
        '200':
          description: Add-on updated
  
  /admin/tenants/addon-requests:
    get:
      operationId: listTenantAddonActivationRequests
      tags: [Tenant Add-ons]
      summary: List activation requests created by current tenant
      parameters:
        - in: query
          name: limit
          schema:
            type: integer
        - in: query
          name: offset
          schema:
            type: integer
      responses:
        '200':
          description: Tenant add-on activation request list
    post:
      operationId: createTenantAddonActivationRequest
      tags: [Tenant Add-ons]
      summary: Create a tenant add-on activation request for platform approval
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [addon_id]
              properties:
                addon_id:
                  type: string
                reason:
                  type: string
                billing_reference:
                  type: string
                settings:
                  type: object
      responses:
        '201':
          description: Activation request created
  
  /admin/platform/tenants/{tenant_id}/addons:
    get:
      operationId: listPlatformTenantAddons
      tags: [Platform Add-ons]
      summary: List add-ons and add-on configuration for a specific tenant
      parameters:
        - in: path
          name: tenant_id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Tenant add-on list
  
  /admin/platform/tenants/{tenant_id}/addons/{addon_id}:
    post:
      operationId: updatePlatformTenantAddon
      tags: [Platform Add-ons]
      summary: Configure/activate an add-on for a specific tenant
      parameters:
        - in: path
          name: tenant_id
          required: true
          schema:
            type: string
        - in: path
          name: addon_id
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                enabled:
                  type: boolean
                settings:
                  type: object
      responses:
        '200':
          description: Tenant add-on updated
  
  /admin/platform/addon-requests:
    get:
      operationId: listPlatformAddonActivationRequests
      tags: [Platform Add-ons]
      summary: List tenant add-on activation requests across platform
      parameters:
        - in: query
          name: tenant_id
          schema:
            type: string
        - in: query
          name: addon_id
          schema:
            type: string
        - in: query
          name: status
          schema:
            type: string
        - in: query
          name: limit
          schema:
            type: integer
        - in: query
          name: offset
          schema:
            type: integer
      responses:
        '200':
          description: Platform add-on request list
  
  /admin/platform/addon-requests/{request_id}/review:
    post:
      operationId: reviewPlatformAddonActivationRequest
      tags: [Platform Add-ons]
      summary: Approve or reject a tenant add-on activation request
      parameters:
        - in: path
          name: request_id
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [decision]
              properties:
                decision:
                  type: string
                  enum: [approve, reject]
                notes:
                  type: string
                billing_reference:
                  type: string
                activate_now:
                  type: boolean
      responses:
        '200':
          description: Request reviewed
  
  /admin/platform/addon-requests/{request_id}/activate:
    post:
      operationId: activatePlatformAddonActivationRequest
      tags: [Platform Add-ons]
      summary: Manually activate an approved add-on request after billing confirmation
      parameters:
        - in: path
          name: request_id
          required: true
          schema:
            type: string
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                billing_reference:
                  type: string
                notes:
                  type: string
      responses:
        '200':
          description: Request activated and add-on enabled for tenant

  # from paths/parent-accountant.yaml
  # Parent & Accountant Specific API Paths
  
  /parent/children:
    get:
      operationId: listParentChildren
      tags: [Parent]
      summary: List children linked to the parent
      responses:
        '200':
          description: Student list
  
  /parent/child/{id}/report-card:
    get:
      operationId: getChildReportCard
      tags: [Parent]
      summary: Get latest report card for a child
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Report card data
  
  /accountant/day-book:
    get:
      operationId: getAccountantDayBook
      tags: [Accountant]
      summary: Get today's accounting day book
      responses:
        '200':
          description: Transaction summary for the day

