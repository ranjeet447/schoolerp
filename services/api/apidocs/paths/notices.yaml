# Notices & Notifications API Paths

/admin/notices:
  get:
    operationId: listNotices
    tags: [Notices]
    summary: List notices and circulars
    description: Returns notices for the tenant with filtering by status and audience.
    parameters:
      - name: status
        in: query
        schema: { type: string, enum: [draft, published, archived] }
      - name: audience
        in: query
        schema: { type: string, enum: [all, parents, teachers, students, staff] }
      - name: limit
        in: query
        schema: { type: integer, default: 50 }
      - name: offset
        in: query
        schema: { type: integer, default: 0 }
    responses:
      '200':
        description: Notice list
        content:
          application/json:
            schema:
              type: array
              items:
                type: object
                properties:
                  id: { type: string, format: uuid }
                  title: { type: string }
                  content: { type: string }
                  status: { type: string }
                  audience: { type: string }
                  published_at: { type: string, format: date-time }
  post:
    operationId: createNotice
    tags: [Notices]
    summary: Create a notice (as draft)
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [title, content]
            properties:
              title: { type: string, example: "Annual Day Celebration" }
              content: { type: string, description: "Markdown-formatted content" }
              audience: { type: string, enum: [all, parents, teachers, students, staff], default: all }
              attachments: { type: array, items: { type: string, format: uri } }
    responses:
      '201':
        description: Notice created as draft

/admin/notices/{id}:
  get:
    operationId: getNotice
    tags: [Notices]
    summary: Get notice detail
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: string, format: uuid }
    responses:
      '200':
        description: Notice detail
  put:
    operationId: updateNotice
    tags: [Notices]
    summary: Update a notice
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: string, format: uuid }
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              title: { type: string }
              content: { type: string }
              audience: { type: string }
    responses:
      '200':
        description: Notice updated
  delete:
    operationId: deleteNotice
    tags: [Notices]
    summary: Delete a notice
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: string, format: uuid }
    responses:
      '200':
        description: Notice deleted

/admin/notices/{id}/publish:
  post:
    operationId: publishNotice
    tags: [Notices]
    summary: Publish a notice
    description: Changes notice status from draft to published and sends notifications.
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: string, format: uuid }
    responses:
      '200':
        description: Notice published

/admin/notifications/send:
  post:
    operationId: sendNotification
    tags: [Notifications]
    summary: Send a notification to users
    description: |
      Sends a notification via push, SMS, email, or WhatsApp to specified
      recipients or target groups.
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [title, body, channel]
            properties:
              title: { type: string }
              body: { type: string }
              channel: { type: string, enum: [push, sms, email, whatsapp] }
              recipients:
                type: array
                items: { type: string, format: uuid }
                description: Specific user IDs (optional if target_group is set)
              target_group:
                type: string
                enum: [all_parents, all_teachers, all_staff, class]
    responses:
      '200':
        description: Notification sent
        content:
          application/json:
            schema:
              type: object
              properties:
                sent_count: { type: integer }
                failed_count: { type: integer }

/admin/notifications/logs:
  get:
    operationId: listNotificationLogs
    tags: [Notifications]
    summary: List notification delivery logs
    parameters:
      - name: channel
        in: query
        schema: { type: string, enum: [push, sms, email, whatsapp] }
      - name: from
        in: query
        schema: { type: string, format: date }
      - name: to
        in: query
        schema: { type: string, format: date }
    responses:
      '200':
        description: Delivery logs

/admin/notifications/templates:
  get:
    operationId: listNotificationTemplates
    tags: [Notifications]
    summary: List notification templates
    responses:
      '200':
        description: Template list
  post:
    operationId: createNotificationTemplate
    tags: [Notifications]
    summary: Create a notification template
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [name, channel, body]
            properties:
              name: { type: string, example: "fee_reminder" }
              channel: { type: string, enum: [push, sms, email, whatsapp] }
              subject: { type: string, description: "For email templates" }
              body: { type: string, description: "Template body with {{variables}}" }
    responses:
      '201':
        description: Template created

/admin/notifications/templates/{id}:
  put:
    operationId: updateNotificationTemplate
    tags: [Notifications]
    summary: Update a notification template
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: string, format: uuid }
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              name: { type: string }
              body: { type: string }
    responses:
      '200':
        description: Template updated
  delete:
    operationId: deleteNotificationTemplate
    tags: [Notifications]
    summary: Delete a notification template
    parameters:
      - name: id
        in: path
        required: true
        schema: { type: string, format: uuid }
    responses:
      '200':
        description: Template deleted
