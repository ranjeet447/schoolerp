# Tenant Add-ons & Platform Add-on Activation Workflow

/admin/tenants/plugins:
  get:
    operationId: listTenantAddons
    tags: [Tenant Add-ons]
    summary: List tenant add-ons with metadata and current enablement
    responses:
      '200':
        description: Tenant add-ons list

/admin/tenants/plugins/{id}:
  post:
    operationId: updateTenantAddonConfig
    tags: [Tenant Add-ons]
    summary: Update active tenant add-on configuration
    parameters:
      - in: path
        name: id
        required: true
        schema:
          type: string
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              enabled:
                type: boolean
              settings:
                type: object
    responses:
      '200':
        description: Add-on updated

/admin/tenants/addon-requests:
  get:
    operationId: listTenantAddonActivationRequests
    tags: [Tenant Add-ons]
    summary: List activation requests created by current tenant
    parameters:
      - in: query
        name: limit
        schema:
          type: integer
      - in: query
        name: offset
        schema:
          type: integer
    responses:
      '200':
        description: Tenant add-on activation request list
  post:
    operationId: createTenantAddonActivationRequest
    tags: [Tenant Add-ons]
    summary: Create a tenant add-on activation request for platform approval
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [addon_id]
            properties:
              addon_id:
                type: string
              reason:
                type: string
              billing_reference:
                type: string
              settings:
                type: object
    responses:
      '201':
        description: Activation request created

/admin/platform/tenants/{tenant_id}/addons:
  get:
    operationId: listPlatformTenantAddons
    tags: [Platform Add-ons]
    summary: List add-ons and add-on configuration for a specific tenant
    parameters:
      - in: path
        name: tenant_id
        required: true
        schema:
          type: string
    responses:
      '200':
        description: Tenant add-on list

/admin/platform/tenants/{tenant_id}/addons/{addon_id}:
  post:
    operationId: updatePlatformTenantAddon
    tags: [Platform Add-ons]
    summary: Configure/activate an add-on for a specific tenant
    parameters:
      - in: path
        name: tenant_id
        required: true
        schema:
          type: string
      - in: path
        name: addon_id
        required: true
        schema:
          type: string
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              enabled:
                type: boolean
              settings:
                type: object
    responses:
      '200':
        description: Tenant add-on updated

/admin/platform/addon-requests:
  get:
    operationId: listPlatformAddonActivationRequests
    tags: [Platform Add-ons]
    summary: List tenant add-on activation requests across platform
    parameters:
      - in: query
        name: tenant_id
        schema:
          type: string
      - in: query
        name: addon_id
        schema:
          type: string
      - in: query
        name: status
        schema:
          type: string
      - in: query
        name: limit
        schema:
          type: integer
      - in: query
        name: offset
        schema:
          type: integer
    responses:
      '200':
        description: Platform add-on request list

/admin/platform/addon-requests/{request_id}/review:
  post:
    operationId: reviewPlatformAddonActivationRequest
    tags: [Platform Add-ons]
    summary: Approve or reject a tenant add-on activation request
    parameters:
      - in: path
        name: request_id
        required: true
        schema:
          type: string
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [decision]
            properties:
              decision:
                type: string
                enum: [approve, reject]
              notes:
                type: string
              billing_reference:
                type: string
              activate_now:
                type: boolean
    responses:
      '200':
        description: Request reviewed

/admin/platform/addon-requests/{request_id}/activate:
  post:
    operationId: activatePlatformAddonActivationRequest
    tags: [Platform Add-ons]
    summary: Manually activate an approved add-on request after billing confirmation
    parameters:
      - in: path
        name: request_id
        required: true
        schema:
          type: string
    requestBody:
      required: false
      content:
        application/json:
          schema:
            type: object
            properties:
              billing_reference:
                type: string
              notes:
                type: string
    responses:
      '200':
        description: Request activated and add-on enabled for tenant


/admin/platform/summary:
  get:
    operationId: getPlatformSummary
    tags: [Platform Admin]
    summary: Get platform-wide summary statistics
    responses:
      '200':
        description: Platform summary overview

/admin/platform/tenants:
  get:
    operationId: listPlatformTenants
    tags: [Platform Admin]
    summary: List all tenants on the platform
    responses:
      '200':
        description: Tenant list

/admin/platform/tenants/{tenant_id}:
  get:
    operationId: getPlatformTenant
    tags: [Platform Admin]
    summary: Get details for a specific tenant
    parameters:
      - in: path
        name: tenant_id
        required: true
        schema: { type: string }
    responses:
      '200':
        description: Tenant details
  patch:
    operationId: updatePlatformTenant
    tags: [Platform Admin]
    summary: Update tenant configuration or profile
    parameters:
      - in: path
        name: tenant_id
        required: true
        schema: { type: string }
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              status: { type: string, enum: [active, suspended] }
    responses:
      '200':
        description: Tenant updated

/admin/platform/tenants/{tenant_id}/lifecycle:
  post:
    operationId: updateTenantLifecycle
    tags: [Platform Admin]
    summary: Update tenant lifecycle status (Suspend/Activate)
    parameters:
      - in: path
        name: tenant_id
        required: true
        schema: { type: string }
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [status]
            properties:
              status: { type: string, enum: [active, suspended] }
              reason: { type: string }
    responses:
      '200':
        description: Lifecycle status updated

/admin/platform/tenants/{tenant_id}/impersonate:
  post:
    operationId: impersonateTenantAdmin
    tags: [Platform Admin]
    summary: Impersonate a tenant administrator
    parameters:
      - in: path
        name: tenant_id
        required: true
        schema: { type: string }
    responses:
      '200':
        description: Impersonation started, returns session token

/admin/platform/monitoring/queue:
  get:
    operationId: getQueueHealth
    tags: [Platform Monitoring]
    summary: Get real-time health and throughput stats for the outbox queue
    responses:
      '200':
        description: Queue monitoring stats

/admin/platform/incidents:
  get:
    operationId: listPlatformIncidents
    tags: [Platform Incidents]
    summary: List platform incidents
    parameters:
      - in: query
        name: limit
        schema: { type: integer, default: 20 }
    responses:
      '200':
        description: Incident list
  post:
    operationId: createPlatformIncident
    tags: [Platform Incidents]
    summary: Report a platform-wide incident
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required: [title, severity, description]
            properties:
              title: { type: string }
              severity: { type: string, enum: [minor, major, critical, maintenance] }
              description: { type: string }
              status: { type: string, default: investigations }
    responses:
      '201':
        description: Incident reported

/admin/platform/incidents/{incident_id}:
  patch:
    operationId: updatePlatformIncident
    tags: [Platform Incidents]
    summary: Update platform incident status or severity
    parameters:
      - in: path
        name: incident_id
        required: true
        schema: { type: string }
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              status: { type: string, enum: [investigating, identified, monitoring, resolved] }
              severity: { type: string }
    responses:
      '200':
        description: Incident updated
